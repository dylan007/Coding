<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<title>Algorithm Tutorials</title>






<script src="maxFlowPushRelabel_files/ga.js" async="" type="text/javascript"></script><script type="text/javascript" src="maxFlowPushRelabel_files/jquery-1.js"></script>
<script type="text/javascript" src="maxFlowPushRelabel_files/jquery-migrate-1.js"></script>
<!--[if lt IE 9]>
<script type="text/javascript" src="/js/reskin/html5shiv.js"></script>
<![endif]-->
<script type="text/javascript" src="maxFlowPushRelabel_files/jquery.js"></script>
<script type="text/javascript" src="maxFlowPushRelabel_files/newTCScript.js"></script><link type="image/x-icon" rel="shortcut icon" href="http://community.topcoder.com/i/favicon.ico">













<link href="maxFlowPushRelabel_files/css.css" rel="stylesheet" type="text/css">
    
    <link type="text/css" rel="stylesheet" href="maxFlowPushRelabel_files/coders.css">
    <link type="text/css" rel="stylesheet" href="maxFlowPushRelabel_files/jobsRemix.css">
    <link type="text/css" rel="stylesheet" href="maxFlowPushRelabel_files/myHome.css">
    
<link type="text/css" rel="stylesheet" href="maxFlowPushRelabel_files/newStyles.css">
<!--[if IE 8]>
<link type="text/css" rel="stylesheet" href="/css/reskin/newStyles_ie8.css"/>
<![endif]-->



<script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(n,t,e){function r(e){if(!t[e]){var o=t[e]={exports:{}};n[e][0].call(o.exports,function(t){var o=n[e][1][t];return r(o?o:t)},o,o.exports)}return t[e].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({QJf3ax:[function(n,t){function e(n){function t(t,e,a){n&&n(t,e,a),a||(a={});for(var u=c(t),f=u.length,s=i(a,o,r),p=0;f>p;p++)u[p].apply(s,e);return s}function a(n,t){f[n]=c(n).concat(t)}function c(n){return f[n]||[]}function u(){return e(t)}var f={};return{on:a,emit:t,create:u,listeners:c,_events:f}}function r(){return{}}var o="nr@context",i=n("gos");t.exports=e()},{gos:"7eSDFh"}],ee:[function(n,t){t.exports=n("QJf3ax")},{}],gos:[function(n,t){t.exports=n("7eSDFh")},{}],"7eSDFh":[function(n,t){function e(n,t,e){if(r.call(n,t))return n[t];var o=e();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(n,t,{value:o,writable:!0,enumerable:!1}),o}catch(i){}return n[t]=o,o}var r=Object.prototype.hasOwnProperty;t.exports=e},{}],D5DuLP:[function(n,t){function e(n,t,e){return r.listeners(n).length?r.emit(n,t,e):(o[n]||(o[n]=[]),void o[n].push(t))}var r=n("ee").create(),o={};t.exports=e,e.ee=r,r.q=o},{ee:"QJf3ax"}],handle:[function(n,t){t.exports=n("D5DuLP")},{}],XL7HBI:[function(n,t){function e(n){var t=typeof n;return!n||"object"!==t&&"function"!==t?-1:n===window?0:i(n,o,function(){return r++})}var r=1,o="nr@id",i=n("gos");t.exports=e},{gos:"7eSDFh"}],id:[function(n,t){t.exports=n("XL7HBI")},{}],loader:[function(n,t){t.exports=n("G9z0Bl")},{}],G9z0Bl:[function(n,t){function e(){var n=v.info=NREUM.info;if(n&&n.licenseKey&&n.applicationID&&f&&f.body){c(d,function(t,e){t in n||(n[t]=e)}),v.proto="https"===l.split(":")[0]||n.sslForHttp?"https://":"http://",a("mark",["onload",i()]);var t=f.createElement("script");t.src=v.proto+n.agent,f.body.appendChild(t)}}function r(){"complete"===f.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=n("handle"),c=n(1),u=window,f=u.document,s="addEventListener",p="attachEvent",l=(""+location).split("?")[0],d={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-515.min.js"},v=t.exports={offset:i(),origin:l,features:{}};f[s]?(f[s]("DOMContentLoaded",o,!1),u[s]("load",e,!1)):(f[p]("onreadystatechange",r),u[p]("onload",e)),a("mark",["firstbyte",i()])},{1:11,handle:"D5DuLP"}],11:[function(n,t){function e(n,t){var e=[],o="",i=0;for(o in n)r.call(n,o)&&(e[i]=t(o,n[o]),i+=1);return e}var r=Object.prototype.hasOwnProperty;t.exports=e},{}]},{},["G9z0Bl"]);</script><script language="JavaScript" src="maxFlowPushRelabel_files/print.js"></script>
<style type="text/css">
.code
{
   width: 550;
   padding: 10px;
   margin: 20px;
   color: #333;
   font-size: 11px;
   font-weight: normal;
   line-height: 14px;
   background-color: #EEEEEE;
   border: 1px solid #999;
}
.math
{
   font-family: times, times new roman, serif;
   font-weight: normal;
   font-style: italic;
   font-size: 14px;
}
</style>
</head>
<body>
<div id="onTop">
    









    
        <header id="navigation" class="newUser">
            <div class="container">
                <div class="headerTopRightMenu">
                    
                        <div class="headerTopRightMenuLink logIn">
                            <div class="text"><a href="http://www.topcoder.com/tc?module=Logout" class="actionLogin">Log Out</a></div>
                            <div class="clear"></div>
                        </div>
                    

                    <div class="separator"></div>
                    <div class="headerTopRightMenuLink contact">
                        <div class="text"><a href="http://www.topcoder.com/contact-us/">Contact</a></div>
                        <div class="clear"></div>
                    </div>
                    <div class="separator"></div>
                    <div class="headerTopRightMenuLink help">
                        <div class="text"><a href="http://help.topcoder.com/">Help Center</a></div>
                        <div class="clear"></div>
                    </div>
                    <div class="separator beforeSearch"></div>
                    <div class="headerTopRightMenuLink search last">
                        <div class="icon"></div>
                        <div class="text"><a href="http://www.topcoder.com/search">Search</a></div>
                        <div class="clear"></div>
                    </div>
                    <div class="clear"></div>
                </div>
                <div class="clear"></div>
                <h1 class="logo">
                    <a href="http://www.topcoder.com/" title="topcoder"></a>
                </h1>
                <nav id="mainNav" class="mainNav">
                    <ul class="root">
                        <li id="nav-menu-item-13018"><a href="http://www.topcoder.com/challenges/" class="13018"><i></i>Challenges</a>
                            <ul class="child">
                                <li id="nav-menu-item-13510"><a href="http://www.topcoder.com/challenges/" class="all"><i></i>All</a></li>
                                <li id="nav-menu-item-13511"><a href="http://www.topcoder.com/active-challenges/design/" class="design"><i></i>Design</a></li>
                                <li id="nav-menu-item-13512"><a href="http://www.topcoder.com/active-challenges/develop/" class="develop"><i></i>Development</a></li>
                                <li id="nav-menu-item-13513"><a href="http://www.topcoder.com/active-challenges/data/" class="data"><i></i>Data Science</a></li>
                                <li id="nav-menu-item-13529"><a href="http://community.topcoder.com/contest/arena/ContestAppletProd.jnlp" class="topcoder-arena"><i></i>topcoder Arena</a></li>
                            </ul>
                        </li>
                        <li id="nav-menu-item-13129"><a href="http://www.topcoder.com/community/" class="13129"><i></i>Community</a>
                            <ul class="child">
                                <li id="nav-menu-item-13509"><a href="http://www.topcoder.com/community/" class="welcome"><i></i>Home</a></li>
                                <li id="nav-menu-item-13034"><a href="http://www.topcoder.com/community/getting-started/" class="13034"><i></i>Getting
                                    Started</a></li>
                                <li id="nav-menu-item-12983"><a href="http://www.topcoder.com/community/how-it-works/" class="customer-solutions"><i></i>How It Works</a></li>
                                <li id="nav-menu-item-13105"><a href="http://apps.topcoder.com/forums/" class="forums"><i></i>Forums</a></li>
                                <li id="nav-menu-item-13036"><a href="http://www.topcoder.com/community/events/" class="13036"><i></i>Events</a></li>
                                <li id="nav-menu-item-15095"><a href="http://community.topcoder.com/tco14" class="topcoder-open-2"><i></i>Topcoder Open 2014</a></li>
                                <li id="nav-menu-item-15218"><a href="http://tco15.topcoder.com/" class="topcoder-open-2015"><i></i>Topcoder Open 2015</a></li>
                                <li><a href="http://www.topcoder.com/community/member-programs/">
                                                                <i></i>Member Programs</a></li>
                                <li id="nav-menu-item-13038"><a href="http://www.topcoder.com/community/stories/" class="13038"><i></i>Stories</a></li>
                            </ul>
                        </li>
                        <li id="nav-menu-item-13469"><a href="http://community.topcoder.com/mission" class="about-us"><i></i>About topcoder</a>
                            <ul class="child">
                                <li id="nav-menu-item-13516"><a href="http://www.topcoder.com/mission/" class="13516"><i></i>Mission</a></li>
                                <li id="nav-menu-item-13032"><a href="http://www.topcoder.com/research/" class="13032"><i></i>Research</a></li>
                                <li id="nav-menu-item-13450"><a href="http://www.topcoder.com/case-studies/" class="case-studies"><i></i>Case Studies</a></li>
                                <li id="nav-menu-item-13045"><a href="http://www.topcoder.com/press/" class="13045"><i></i>Press</a></li>
                            </ul>
                        </li>
                        <li id="nav-menu-item-13379"><a href="http://www.topcoder.com/blog/" class="13379"><i></i>Blog</a></li>
                        <!--
                        <li class="noReg logoutLink 	hide"><a href="http://www.topcoder.com?auth=logout" class="actionLogout">Log Out</a></li>
                        <li class="noReg loginLink"><a href="javascript:;" class="actionLogin">Log In</a></li>
                        -->
                    </ul>
                </nav>
                <!--
                <a href="http://www.topcoder.com?auth=logout" class="onMobi noReg linkLogout actionLogout hide">Log Out</a>
                  <a href="javascript:;" class="onMobi noReg linkLogin actionLogin">Log In</a>
                -->
                
                    <span class="btnRegWrap noReg"><a href="http://www.topcoder.com/tc?module=MyHome" class="btn btnMyHome">My Home</a></span>
                

                <!-- /.userWidget -->
            </div>
        </header>
    
    




</div>
<table style="visibility: visible;" class="mainContent" width="100%" border="0" cellpadding="0" cellspacing="0">
    <tbody><tr class="alignTop" valign="top">
        <!-- Left Column Begins-->
        <td id="onLeft" width="180">







    
        
            
            
        






<div style="width: 185px; display: block;" class="leftNavWrapper">
    
<input id="nodeName" value="algo_tutorials" type="hidden">
<script language="JavaScript" type="text/javascript" src="maxFlowPushRelabel_files/arena.js"></script>

    <section class="get-time" style="margin-bottom:15px">
        
        <span class="date"></span>
        <a href="javascript:tcTime();">Get Time</a>
    </section>
    <!-- End .get-time -->

    <section class="navigation">
    <ul>
        <li><a id="copilot_posting_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Copilot%20Posting">Copilot Posting</a></li>
        <li><a href="http://www.topcoder.com/active-challenges/design/">Design</a></li>
        <li>
            <a href="javascript:;">Develop<i></i></a>
            <ul class="hide">
                <li><a id="conceptualization_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Conceptualization">Conceptualization</a></li>
                <li><a id="specification_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Specification">Specification</a></li>
                <li><a id="architecture_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Architecture">Architecture</a></li>
                <li><a id="ui_prototype_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=UI%20Prototype%20Competition">UI Prototype</a></li>
                <li><a id="assembly_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Assembly%20Competition">Assembly</a></li>
                <li><a id="first2finish_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=First2Finish">First2Finish</a></li>
                <li><a id="code_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Code">Code</a></li>
                <li><a id="des_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Design">Component Design</a></li>
                <li><a id="dev_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Development">Component Development</a></li>
                <li><a id="test_suites_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Test%20Suites">Test Suites</a></li>
                <li><a id="content_creation_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Content%20Creation">Content Creation</a></li>
                <li><a id="test_scenarios_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Test%20Scenarios">Test Scenarios</a></li>
                <li><a id="bug_hunt_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Bug%20Hunt">Bug Hunt</a></li>
            </ul>
        </li>
        <li>
            <a href="javascript:;">Review Opportunities<i></i></a>
            <ul class="hide">
                <li>
                    <dl>
                        <dt>Conceptualization</dt>
                        <dd><a id="conceptualization_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=23">Review Opportunities</a></dd>
                        <dd><a id="conceptualization_review_border" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=23">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Specification</dt>
                        <dd><a id="specification_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=6">Review Opportunities</a></dd>
                        <dd><a id="specification_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=6">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Architecture</dt>
                        <dd><a id="architecture_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=7">Review Opportunities</a></dd>
                        <dd><a id="architecture_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=7">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Component Design</dt>
                        <dd><a id="des_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=1">Review Opportunities</a></dd>
                        <dd><a id="des_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=1">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Component Development</dt>
                        <dd><a id="dev_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=2">Review Opportunities</a></dd>
                        <dd><a id="dev_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=2">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Assembly</dt>
                        <dd><a id="assembly_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=14">Review Opportunities</a></dd>
                        <dd><a id="assembly_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=14">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>First2Finish</dt>
                        <dd><a id="first2finish_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=38">Review Opportunities</a></dd>
                        <dd><a id="first2finish_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=38">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Code</dt>
                        <dd><a id="code_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=39">Review Opportunities</a></dd>
                        <dd><a id="code_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=39">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Test Suites</dt>
                        <dd><a id="test_suites_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=13">Review Opportunities</a></dd>
                        <dd><a id="test_suites_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=13">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Report</dt>
                        <dd><a id="reporting_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=36">Review Opportunities</a></dd>
                        <dd><a id="reporting_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=36">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>UI prototype</dt>
                        <dd><a id="ui_prototype_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=19">Review Opportunities</a></dd>
                        <dd><a id="ui_prototype_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=19">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>RIA Build</dt>
                        <dd><a id="ria_build_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=24">Review Opportunities</a></dd>
                        <dd><a id="ria_build_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=24">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Content Creation</dt>
                        <dd><a id="content_creation_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=35">Review Opportunities</a></dd>
                        <dd><a id="content_creation_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=35">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Test Scenarios</dt>
                        <dd><a id="test_scenarios_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=26">Review Opportunities</a></dd>
                        <dd><a id="test_scenarios_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=26">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl class="last-item">
                        <dt>Bug Hunt</dt>
                        <dd><a id="bug_hunt_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=9">Review Opportunities</a></dd>
                        <dd><a id="bug_hunt_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=9">Meet the review board</a></dd>
                    </dl>
                </li>

            </ul>
        </li>
        <li>
            <a href="javascript:;">Algorithm (SRM)<i></i></a>
            <ul class="hide">
                <li><a href="http://www.topcoder.com/active-challenges/data/">Single Round Matches (SRM)</a></li>
                <li><a id="algo_match_archive" href="http://www.topcoder.com/tc?module=MatchList">Match Archive</a></li>
                <li><a id="algo_match_overviews" href="http://www.topcoder.com/stat?c=round_overview">Match Overviews</a></li>
                <li><a id="algo_match_winners" href="http://www.topcoder.com/tc?module=SrmDivisionWins">Match Winners</a></li>
                <li><a id="algo_match_results" href="http://www.topcoder.com/stat?c=last_match">Match Results</a></li>
                <li><a href="http://apps.topcoder.com/wiki/display/tc/Algorithm+Problem+Set+Analysis">Match Editorials</a></li>
                <li><a id="algo_problem_archive" href="http://www.topcoder.com/tc?module=ProblemArchive">Problem Archive</a></li>
                <li><a id="algo_color_changes" href="http://www.topcoder.com/tc?module=ColorChange&amp;ratid=1">Recent Color Changes</a></li>
                <li><a href="http://apps.topcoder.com/wiki/display/tc/Algorithm+Data+Feeds">Data Feeds</a></li>
                <li><a href="javascript:arena();">Launch Arena</a></li>
            </ul>
        </li>
        <li>
            <a href="javascript:;">Marathon Match<i></i></a>
            <ul class="hide">
                <li><a id="long_compete" href="http://www.topcoder.com/challenges/data/active/">Challenges</a></li>
                <li><a id="long_match_archive" href="http://www.topcoder.com/challenges/data/past/">Match Archive</a></li>
                <li><a id="long_match_overview" href="http://www.topcoder.com/longcontest/stats/?module=ViewOverview">Match Overview</a></li>
                <li><a id="long_match_winners" href="http://www.topcoder.com/longcontest/stats/?module=MatchWinners">Match Winners</a></li>
                <li><a id="long_editorials" href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=match_editorials&amp;d2=archive">Match Editorials</a></li>
                <li><a id="long_data_feeds" href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=support&amp;d2=dataFeed">Data Feeds</a></li>
                <li><a id="long_practice" href="http://www.topcoder.com/longcontest/?module=ViewPractice">Practice</a></li>
                <li><a id="long_queue" href="http://www.topcoder.com/longcontest/?module=ViewQueue">Queue Status</a></li>
            </ul>
        </li>
        <li><a href="http://www.topcoder.com/dr">The Digital Run</a></li>
        <li><a href="http://software.topcoder.com/review">Submit &amp; Review</a></li>
        <li>
            <a href="javascript:;">topcoder Networks<i></i></a>
            <ul class="hide">
                <li><a href="http://community.topcoder.com/ntl/">NASA Tournament Lab</a></li>
            </ul>
        </li>
        <li><a href="http://www.topcoder.com/community/events/">Events</a></li>
        <li>
            <a href="javascript:;">Statistics<i></i></a>
            <ul class="hide">
                <li>
                    <dl>
                        <dt>Top Ranked</dt>
                        <dd><a id="top_rated_algo" href="http://www.topcoder.com/tc?module=AlgoRank">Algorithm</a></dd>
                        <dd><a id="top_rated_hs" href="http://www.topcoder.com/tc?module=HSRank">High School</a></dd>
                        <dd><a id="top_rated_long" href="http://www.topcoder.com/longcontest/stats/?module=CoderRank">Marathon Match</a></dd>
                        <dd><a id="top_rated_conceptors" href="http://www.topcoder.com/stat?c=top_conceptors">Conceptualization</a></dd>
                        <dd><a id="top_rated_specificators" href="http://www.topcoder.com/stat?c=top_specificators">Specification</a></dd>
                        <dd><a id="top_rated_architects" href="http://www.topcoder.com/stat?c=top_architects">Architecture</a></dd>
                        <dd><a id="top_rated_des" href="http://www.topcoder.com/stat?c=top_designers">Design</a></dd>
                        <dd><a id="top_rated_dev" href="http://www.topcoder.com/stat?c=top_developers">Development</a></dd>
                        <dd><a id="top_rated_assemblers" href="http://www.topcoder.com/stat?c=top_assemblers">Assembly</a></dd>
                        <dd><a id="top_rated_testers" href="http://www.topcoder.com/stat?c=top_testers">Test Suites</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Record Book</dt>
                        <dd><a id="algo_recordbook" href="http://www.topcoder.com/tc?module=Static&amp;d1=statistics&amp;d2=recordbook_home">Algorithm</a></dd>
                        <dd><a id="comp_recordbook" href="http://www.topcoder.com/tc?module=Static&amp;d1=compstats&amp;d2=comp_recordbook_home">Component</a></dd>
                        <dd><a id="long_recordbook" href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=stats&amp;d2=recordbook_home">Marathon Match</a></dd>
                    </dl>
                </li>
                <li>
                    <dl class="last-item">
                        <dt>Coder of the Month</dt>
                        <dd><a id="algo_com" href="http://www.topcoder.com/tc?module=COMHistory&amp;achtid=5">Algorithm</a></dd>
                        <dd><a id="des_com" href="http://www.topcoder.com/tc?module=COMHistory&amp;achtid=6">Design</a></dd>
                        <dd><a id="dev_com" href="http://www.topcoder.com/tc?module=COMHistory&amp;achtid=7">Development</a></dd>
                    </dl>
                </li>
            </ul>
        </li>
        <li class="expanded">
            <a href="javascript:;">Tutorials<i></i></a>
            <ul style="display: block;" class="hide">
                <li><a style="color: rgb(255, 138, 0); font-weight: bold;" id="algo_tutorials" href="http://help.topcoder.com/data-science/competing-in-algorithm-challenges/algorithm-tutorials/">Algorithm Tutorials</a></li>
                <li><a id="comp_tutorials" href="http://help.topcoder.com/development/competing-in-development-challenges/development-tutorials/">Software Tutorials</a></li>
                <li><a id="mm_tutorials" href="http://help.topcoder.com/data-science/competing-in-algorithm-challenges/marathon-match-tutorials/">Marathon Tutorials</a></li>
            </ul>
        </li>
        <li><a href="https://apps.topcoder.com/forums/" id="forums">Forums</a></li>
        <li><a href="https://www.topcoder.com/tc?module=MyHome" id="my_topcoder">My topcoder</a></li>
    </ul>
</section>
<!-- End .navigation -->
<section class="member-search">
    <h3>Member Search</h3>
    <div class="form">
        <form action="http://community.topcoder.com/tc" method="get" name="simpleSearchForm" class="noSpace" id="simpleSearchForm">
            <input class="noSpace" name="module" value="SimpleSearch" type="hidden">
            <input class="noSpace" name="ha" value="Handle:" size="12" maxlength="15" onfocus="javascript: if (document.simpleSearchForm.ha.value=='Handle:') document.simpleSearchForm.ha.value = '';" onblur="javascript:if (document.simpleSearchForm.ha.value == '')document.simpleSearchForm.ha.value = 'Handle:';" type="text">
            <a href="javascript:javascript:void%20document.simpleSearchForm.submit();" class="btn btn-search-member"><i>SEARCH</i></a>
        </form>
    </div>
</section>

<!-- End .member-search -->

</div>

    
    



        </td>
        <!-- Left Column Ends -->
        <!-- Center Column Begins -->
        <td class="bodyColumn" width="100%" align="left">
            





<table style="visibility: visible;" class="pageTitleTable" cellpadding="0" cellspacing="0">
    <tbody><tr>
        <td class="pageTitle" width="100%">


            
                
                    
                    <img src="maxFlowPushRelabel_files/header_alg_tut.gif" alt="alg_tut" border="0">
                
                
            


        </td>
        <td class="pageSubtitle" align="right">&nbsp;&nbsp;</td>
    </tr>
</tbody></table>


            <div class="linkBox">
                <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=alg_index">Archive</a><br>
                <span id="printableLink"><a href="javascript:makeInvisible();">Printable view</a><br></span>
                <span id="navigableLink" class="invisible"><a href="javascript:makeNavigable();">Normal view</a><br></span>
                <a href="http://forums.topcoder.com/?module=ThreadList&amp;forumID=517411">Discuss this article</a><br>
                <a href="http://community.topcoder.com/tc?module=Static&amp;d1=help&amp;d2=writeForTC">Write for TopCoder</a>
            </div>


<span class="bigTitle">Push-Relabel Approach to the Maximum Flow Problem </span>
<br><br>

<div class="authorPhoto">
    <img src="maxFlowPushRelabel_files/NilayVaish_big.html" alt="Author">
</div>
<div class="authorText">
  By&nbsp;<a href="http://www.topcoder.com/tc?module=MemberProfile&amp;cr=21500759&amp;tab=alg" class="coderTextBlue">NilayVaish</a><br>
      <em>TopCoder Member</em>
</div>

<br clear="all">

<p><span class="bodySubtitle">Introduction</span><br>
This article presents a new approach for computing maximum flow in a 
graph. Previous articles had concentrated on finding maximum flow by 
finding augmenting paths. <strong>Ford-Fulkerson</strong> and <strong>Edmonds-Karp</strong> algorithms belong to that class. The approach presented in this article is called <strong>push-relabel</strong>, which is a separate class of algorithms. We'll look at an algorithm first described by <strong>Andrew V. Goldberg</strong> and <strong>Robert E. Tarjan</strong>,
 which is not very hard to code and, for dense graphs, is much faster 
than the augmenting path algorithms. If you haven't yet done so, I'd 
advise you to review the articles on <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=graphsDataStrucs1">graph theory</a> and <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=maxFlow">maximum flow</a> using augmenting paths for a better understanding of the basic concepts on the two topics. </p>

<p><span class="bodySubtitle">The Standard Maximum Flow Problem</span><br>
Let <strong>G</strong> = <strong>(V,E)</strong> be a directed graph with vertex set <strong>V</strong> and edge set <strong>E</strong>. Size of set <strong>V</strong> is <strong>n</strong> and size of set <strong>E</strong> is <strong>m</strong>. <strong>G</strong> has two distinguished vertices, a source <strong>s</strong> and a sink <strong>t</strong>. Each edge <strong>(u,v)</strong><strong> &#949; </strong><strong>E</strong> has a capacity <strong>c(u,v)</strong>. For all edges <strong>(u,v)</strong><strong> &#8713;</strong><strong>E</strong>, we define <strong>c(u,v) = 0</strong>. A flow f on <strong>G</strong> is a real valued function satisfying the following constraints: </p>

<ol>
  <li><strong> Capacity</strong><strong>:</strong><strong> f(v,w) </strong><strong> &#8804;</strong><strong> c(v,w) </strong><strong> &#8744;</strong><strong></strong><strong> (v,w) </strong><strong> &#8714;</strong><strong> V × V </strong></li>
  <li><strong> Anti-symmetry</strong><strong>:</strong><strong> f(v,w) = </strong> – <strong>f(w,v) </strong><strong> &#8744;</strong><strong> (v,w) </strong><strong> &#8714;</strong><strong> V × V </strong></li>
  <li><strong> Flow Conservation</strong><strong>: </strong><strong> &#8721;</strong><strong></strong><strong> u </strong><strong> &#8714; </strong><strong> V</strong><strong></strong><strong> f(u,v) = 0 </strong><strong> &#8744;</strong><strong></strong><strong> v </strong><strong> &#8714;</strong><strong> V - {s,t} </strong></li>
</ol>

<p>The value of a flow f is the net flow into the sink i.e. <strong> | f | = </strong><strong> &#8721;</strong><strong></strong><strong> u </strong><strong> &#8714; </strong><strong> V</strong><strong></strong><strong> f(u,t)</strong> . <strong>Figure 1</strong>
 below shows a flow network with the edges marked with their capacities.
 Using this network we will illustrate the steps in the algorithm. </p>

<p align="center"><img src="maxFlowPushRelabel_files/maxflow_push1.gif"></p>

<p align="center"> Figure 1 : Flow Network with Capacities </p>

<p><span class="bodySubtitle">Intuitive Approach Towards the Algorithm</span><br>
Assume that we have a network of water tanks connected with pipes in 
which we want to find the maximum flow of water from the source tank to 
the sink tank. Each of these water tanks are arbitrarily large and will 
be used for accumulating water. A tank is said to be overflowing if it 
has water in it. Tanks are at a height from the ground level. The edges 
can be assumed to be pipes connecting these water tanks. The natural 
action of water is to flow from a higher level to a lower level. The 
same holds for this algorithm. The height of the water tank determines 
the direction in which water will flow. We can push <strong>new flow</strong>
 from a tank to another tank that is downhill from the first tank, i.e. 
to tanks that are at a lesser height than the first tank. We need to 
note one thing here, however:<strong>The flow from a lower tank to a higher tank might be positive.</strong> Present height of a tank only determines the direction of new flow. </p>
<p> We fix the initial height of the source <strong>s</strong> at <strong>n</strong> and that of sink <strong>t</strong> at <strong>0</strong>. All other tanks have initial height <strong>0</strong>,
 which increases with time. Now send as much as possible flow from the 
source toward the sink. Each outgoing pipe from the source s is filled 
to capacity. We will now examine the tanks other than <strong>s</strong> and <strong>t</strong>.
 The flow from overflowing tanks is pushed downhill. If an overflowing 
tank is at the same level or below the tanks to which it can push flow, 
then this tank is raised just enough so that it can push more flow. If 
the sink t is not reachable from an overflowing tank, we then send this 
excess water back to the source. This is done by raising the overflowing
 tank the fixed height <strong>n</strong> of the source. Eventually all the tanks except the source <strong>s</strong> and the sink <strong>t</strong> stop overflowing. At this point the flow from the source to the sink is actually the max-flow. </p>

<p><span class="bodySubtitle">Mathematical Functions</span><br>
In this section we'll examine the mathematical notations required for better understanding of the algorithm. </p>
<ol>
  <li><strong> Preflow</strong> - Intuitively preflow function gives the
 amount of water flowing through a pipe. It is similar to the flow 
function. Like flow, it is a function <strong>f: V × V &#8594; R</strong>. It 
also follows the capacity and anti-symmetry constraints. But for the 
preflow function, the conservation constraint is weakened. 
<p align="center"><strong> &#8721;</strong><strong></strong><strong> u </strong><strong> &#8714; </strong><strong> V</strong><strong></strong><strong> f(u,v) </strong><strong> &#8805;</strong><strong> 0 </strong><strong> &#8744;</strong><strong> v </strong><strong> &#8714;</strong><strong> V - {s,t} </strong></p>
That is the total net flow at a vertex other than the source that is 
non-negative. During the course of the algorithm, we will manipulate 
this function to achieve the maximum flow. <br>
  </li>

  <li><strong> Excess Flow</strong> - We define the excess flow <strong>e</strong> as <strong>e(u) = f(V,u)</strong>, the net flow into <strong>u</strong>. A vertex <strong>u </strong><strong> &#8714;</strong><strong> V-{s,t}</strong> is overflowing / active if <strong>e(u) &gt; 0</strong>. <br></li>

  <li><strong> Residual Capacity</strong> - We define residual capacity as function <strong>cf: V × V </strong><strong> &#8594;</strong><strong> R</strong> where </li>
<p align="center"><strong> cf(u,v) = c(u,v) – f(u,v) </strong></p>
If <strong>cf(u,v) &gt; 0</strong>, then <strong>(u,v)</strong> is called a <strong>residual edge</strong>. Readers would have come across this concept in augmenting path algorithms as well.<br>

  <li><strong> Height</strong> - This function is defined as <strong>h: V </strong><strong> &#8594;</strong><strong> N</strong>. It denotes the height of a water tank. It has the following properties - 
  <ul>
    <li><strong> h(s) = n </strong></li>
    <li><strong> h(t) = 0 </strong></li>
    <li><strong> h(u) &#8804; h(v) + 1 for every residual edge (u,v). </strong></li>
  </ul>
We will prove the last property while discussing the correctness of the algorithm.<br></li></ol>

<p><span class="bodySubtitle">Basic Operations</span><br>
Following are the three basic functions that constitute the algorithm: </p>

<ol>
  <li><strong> Initialization</strong> – This is carried out once during
 the beginning of the algorithm. The height for all the vertices is set 
to zero except the source for which the height is kept at <strong>n</strong>.
 The preflow and the excess flow functions for all vertices are set to 
zero. Then all the edges coming out the source are filled to capacity. <strong>Figure 2</strong> shows the network after initialization. </li>

<p align="center"><img src="maxFlowPushRelabel_files/maxflow_push2.gif" height="195" width="362"><br>
  Figure 2 : Network after Initialization </p>
<p>&nbsp; </p>
<p align="center"><img src="maxFlowPushRelabel_files/maxflow_push3.gif"></p>

<p align="center"> Figure 3 : Code for Initialization </p>
<p>&nbsp; </p>

  <li><strong> push(u,v)</strong> - This operation pushes flow from an 
overflowing tank to a tank to which it has a pipe that can take in more 
flow and the second tank is at a lower height than the first one. In 
other words, if vertex <strong>u</strong> has a positive excess flow, <strong>cf(u,v) &gt; 0</strong> and <strong>h(u) &gt; h(v)</strong>, then flow can be pushed onto the residual edge <strong>(u,v)</strong>. The amount of the flow pushed is given by <strong>min(e(u),cf(u,v))</strong>.<br><br>
<strong> Figure 4</strong> shows a vertex <strong>B</strong> that has an excess flow of <strong>10</strong>. It makes two pushes. In the first push, <strong>7</strong> units of flow are pushed to <strong>C</strong>. In the second push, <strong>3</strong> units of flow are pushed to <strong> E. Figure 5 </strong> illustrates the final result. <p></p>
<p align="center"><img src="maxFlowPushRelabel_files/maxflow_push4.gif" height="216" width="403"></p>
<p align="center"> Figure 4 : Network before pushing flow from B </p>
<p>&nbsp; </p>
<p align="center"><img src="maxFlowPushRelabel_files/maxflow_push5.gif"></p>
<p align="center"> Figure 5 : Network pushing flow from B </p>
<p>&nbsp; </p>
<p align="center"><img src="maxFlowPushRelabel_files/maxflow_push6.gif"></p>
<p align="center"> Figure 6 : Code for Push sub-routine </p></li>
  <li><strong> relabel(u)</strong> - This operation raises the height of an overflowing tank that has no other tanks downhill from it. It applies if <strong>u</strong> is overflowing and <strong>h(u) &#8804; h(v)</strong> &#8744; residual edges <strong>(u,v)</strong> i.e. on all the residual edges from <strong>u</strong>, flow cannot be pushed. The height of the vertex <strong>u</strong> is increased by <strong>1</strong> more than the minimum height of its neighbor to which <strong>u</strong> has a residual edge.

    <p align="center"><strong><img src="maxFlowPushRelabel_files/maxflow_push7.gif"></strong></p>
<p align="center"> Figure 7 : Network after relabeling D </p>
<p>In <strong>Figure 4</strong>, pick up vertex <strong>D</strong> for applying the push operation. We find that it has no vertex that is downhill to it and the edge from <strong>D</strong> to that vertex has excess capacity. So we relabel <strong>D</strong> as shown in <strong>Figure 5.</strong></p>
<p align="center"><img src="maxFlowPushRelabel_files/maxflow_push8.gif"></p>
<p align="center">Figure 8 : Code for Relabel sub-routine</p>
</li></ol>

<p><span class="bodySubtitle">Generic Algorithm</span><br>
The generic algorithm is as follows:<br>
</p><p align="center"><img src="maxFlowPushRelabel_files/image096.gif"></p>

<p>The value <strong>e(t)</strong> will represent the maximum flow. We 
now try to see why this algorithm would work. This would need two 
observations that hold at all times during and after the execution of 
the algorithm.</p>
<ol>
  <li><strong> A residual edge from u to v implies h(u) &#8804; h(v) + 1</strong> -We had earlier introduced this as a property of the height function. Now we make use of induction for proving this property. </li>

    <ul>
  <li> Initially residual edges are from vertices of height 0 to the source that is at height <strong>n</strong>. </li>
  <li> Consider a vertex <strong>u</strong> getting relabeled and <strong>v</strong> is the vertex of minimum height to which <strong>u</strong> has a residual edge. After relabeling, the property holds for the residual edge <strong>(u,v)</strong>. For any other residual edge <strong>(u,w)</strong>, <strong>h(v)</strong><strong> &#8804;</strong><strong>h(w)</strong>. So after relabeling the property will hold for residual edge <strong>(u,w)</strong>. For a residual edge, <strong>(w,u)</strong>, since <strong>u</strong>’s height only goes up, therefore the property will continue to hold trivially. </li>
  <li> Consider a push operation from <strong>u</strong> to <strong>v</strong>. After the operation, edge (v,u) will be present in the residual graph. Now <strong>h(u) &gt; h(v)</strong> &#8743; <strong>h(u) &#8804; h(v) + 1</strong></li>
    </ul>
<blockquote>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong> &#8594;</strong><strong> h(u) = h(v) + 1 </strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong> &#8594;</strong><strong> h(v) = h(u) &#8722; 1 </strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong> &#8594;</strong><strong> h(v) _ h(u) + 1 </strong></blockquote>

  <li><strong> There is no path for source to sink in the residual graph</strong> - Let there be a simple path <strong>{v<sub>0</sub> , v<sub>1</sub> , . . . , v<sub>k&#8722;1</sub>, v<sub>k</sub> }</strong> from <strong>v<sub>0</sub> = s</strong> to <strong>v<sub>k</sub> = t</strong>. Then, as per the above observation, 
    <blockquote>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong> h(v</strong><strong> i</strong><strong> ) &#8804; h(v</strong><strong> i+1</strong><strong> ) + 1 </strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong> &#8594;</strong><strong> h(s) &#8804; h(t) + k </strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong> &#8594;</strong><strong> n &#8804; k </strong><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong> &#8594;</strong><strong> n &lt; k + 1 </strong></blockquote>

<p> This violates the simple path condition as the path has <strong>k+1</strong> vertices. Hence there is no path from source to sink. </p>
</li></ol>

<p> When the algorithm ends, no vertex is overflowing except the source 
and the sink. There is also no path from source to sink. This is the 
same situation in which an augmenting path algorithm ends. Hence, we 
have maximum flow at the end of the algorithm. </p>

<p><span class="bodySubtitle">Analysis </span><br>
The analysis requires proving certain properties relating to the algorithm. </p>
<p align="center"><img src="maxFlowPushRelabel_files/maxflow_push8a.gif" height="168" width="347"></p>
<ol>
  <li><strong> s is reachable from all the overflowing vertices in the residual graph</strong> - Consider <strong>u</strong> as an overflowing and <strong>S</strong> as the set of all the vertices that are reachable from <strong>u</strong> in the residual graph. Suppose <strong>s </strong><strong> &#8713;</strong><strong> 2S</strong> . Then for every vertex pair <strong>(v,w)</strong> such that <strong>v </strong><strong> &#8714;</strong><strong> S</strong> and <strong>w </strong><strong> &#8714;</strong><strong> V-S</strong> , <strong>f(w,v) &#8804; 0</strong>. Because if <strong>f(w,v) &gt; 0</strong>, then <strong>cf(v,w) &gt; 0</strong> which implies <strong>w</strong> is reachable from <strong>u</strong>. Thus, since <strong>e(v) &#8804; 0</strong>, for all <strong>v</strong><strong> &#8714;</strong><strong> S, e(v) = 0</strong>. In particular, <strong>e(u) = 0</strong>, which is a contradiction. <br>
  </li>
  <li><strong> The height of a vertex never decreases</strong> - The height of a vertex changes only during the <strong>relabeling</strong> operation. Suppose we relabel vertex <strong>u</strong>. Then for all vertices <strong>v</strong> such that <strong>(u,v)</strong> is a residual edge, we have <strong>h(v) &#8804; h(u)</strong>, which clearly means <strong>h(v)+1&gt;h(u)</strong>. So the height of a vertex never decreases. <br>
  </li>
  <li><strong> The height of a vertex can be at maximum 2n-1</strong> - This holds for <strong>s</strong> and <strong>t</strong> since their heights never change. Consider a vertex <strong>u</strong> such that <strong>e(u) &gt; 0</strong>. Then there exists a simple path from <strong>u</strong> to <strong>s</strong> in the residual graph. Let this path be <strong>u = v<sub>0,</sub> v<sub>1</sub> , . . . , v<sub>k&#8722;1</sub>, v<sub>k</sub> = s</strong>. Then <strong>k</strong> can be at most <strong>n-1</strong>. Now, as per the definition of <strong>h</strong>, <strong>h(v<sub>i</sub>) &#8804; h(v<sub>i+1</sub>) + 1</strong>. This would yield <strong>h(u) &#8804; h(s) + n – 1 = 2n – 1</strong>. </li>
</ol>
<p> Now we are in a position to count the number of operations that are carried out during the execution of the code.</p>
<ul>
  <li><strong> Relabeling operations</strong> - The height for each vertex other than <strong>s</strong> and <strong>t</strong> can change from <strong>0</strong> to <strong>2n-1</strong>. It can only increase, so there can be utmost <strong>2n-1</strong> relabelings for each vertex. In total there can be a maximum of <strong>(2n-1)(n-2)</strong> relabelings. Each relabeling requires at most <strong>degree(vertex)</strong>
 operations. Summing this up over all the vertices and over all the 
relabelings, the total time spent in relabeling operations is <strong>O(nm)</strong>. <br>
  </li>
  <li><strong> Saturated Pushes</strong> - A saturating push from <strong>u</strong> to <strong>v</strong>, results in <strong>f(u,v) = c(u,v)</strong>. In order to push flow from <strong>u</strong> to <strong>v</strong> again, flow must be pushed from <strong>v</strong> to <strong>u</strong> first. Since <strong>h(u) = h(v) + 1</strong>, so <strong>v</strong>’s height must increase by at least <strong>2</strong>. Similarly <strong>h(u)</strong> should increase by at least<strong> 2</strong> for the next push. Combining this with the earlier result on the maximum height of a<strong></strong>vertex, the total number of saturating pushes is at most <strong>2n-1</strong> per edge. So that total over<strong></strong>all the edges is at most <strong>(2n-1)m &lt; 2nm</strong>.<strong><br>
  </strong></li>
  <li><strong> Non-saturated Pushes</strong> - Let <strong>&#966;</strong> = <strong> &#8721; </strong><strong> u </strong><strong> &#8714;</strong><strong> V, u is active</strong><strong></strong><strong> h(u)</strong>. Each non-saturating push from a vertex <strong>u</strong> to any other vertex <strong>v</strong> causes <strong>&#966;</strong> to decrease by at least <strong>1</strong> since <strong>h(u) &gt; h(v)</strong>. Each saturating push can increase <strong>&#966;</strong> by at most <strong>2n-1</strong> since it could be that <strong>v</strong> was not active before. The total increase in <strong>&#966;</strong> due to saturating pushes is at most <strong>(2n-1)(2nm)</strong>. The total increase in <strong>&#966;</strong> due to relabeling operation is at most <strong>(2n-1)(n-2)</strong>. Therefore, the total number of non-saturating pushes is at most <strong>(2n-1)(2nm) + (2n-1)(n-2)</strong><strong>&#8804; 4n</strong><strong><sup>2</sup>m</strong>. </li>
</ul>

<p> Thus the generic algorithm takes <strong>O(n</strong><strong><sup>2</sup></strong><strong>m)</strong> operations in total. Since each push operation requires <strong>O(1)</strong> time, hence the running time of the algorithm will also be <strong>O(n</strong><strong><sup>2</sup>m) </strong> if the condition given in the while loop can be tested in <strong>O(1)</strong>
 time. The next section provides an implementation for doing the same. 
In fact, by ordering the operations in a particular manner, a more 
rigorous analysis proves that a better time bound can be achieved. </p>

<p><span class="bodySubtitle">First-in First-out Algorithm </span><br>
We will make use of a first-in, first-out strategy for selecting 
vertices on which push/relabel operation will be performed. This is done
 by creating a queue of vertices that are overflowing. Initially all the
 overflowing vertices are put into the queue in any order. We will run 
the algorithm till the queue becomes empty. </p>

<p> In every iteration the vertex at the front of the queue is chosen for carrying out the operations. Let this vertex be <strong>u</strong>. Consider all the edges of <strong>u</strong>, both those that are incident on <strong>u</strong> and those that are incident on other vertices from <strong>u</strong>. These are edges along which <strong>u</strong>
 can potentially push more flow. Go through these edges one by one, 
pushing flow along edges that have excess capacity. This is done until 
either <strong>u</strong> becomes inactive or all the edges have been 
explored. If during the iteration any new vertex starts to overflow, 
then add that vertex to the end of the queue. If at the end of the 
iteration <strong>u</strong> is still overflowing, then it means <strong>u</strong> needs a relabeling. Relabel <strong>u</strong> and start the next iteration with <strong>u</strong> at the front of the queue. If any time during the process or at end of it <strong>u</strong> becomes inactive, remove <strong>u</strong> from the queue. This process of pushing excess flow from a vertex until it becomes inactive is called <strong>discharging a vertex</strong>. </p>
<p align="center"><img src="maxFlowPushRelabel_files/maxflow_push9.jpg"></p>
<p align="center"> Figure 9 : Code for First-In First-Out Algorithm </p>

<p><span class="bodySubtitle">Analysis of First-In First-Out Algorithm </span><br>
To analyze the strategy presented above, the concept of a <strong>pass over a queue</strong> needs to be defined. <strong>Pass 1</strong> consists of discharging the vertices added to the queue during initialization. <strong>Pass i + 1</strong> consists of discharging vertices added during the <strong>Pass i</strong>. </p>

<ul>
  <li><strong> The number of passes over the queue is at most 4n<sup>2</sup></strong> - Let <strong>&#966; </strong>= <strong>max {h(u) </strong>|<strong>u is active|}</strong>. If no heights changes during a given pass, each vertex has its excess moved to vertices that are lower in height. Hence <strong>&#966;</strong> decreases during the pass. If <strong>&#966; </strong>does not change, then there is at least one vertex whose height increases by at least 1. If <strong>&#966;</strong> increases during a pass, then some vertex’s height must have increased by as much as the increase <strong>&#966;</strong>. Using the proof about the maximum height of the vertex, the maximum number of passes in which <strong>&#966;</strong> increases or remains same is <strong>2n</strong><strong><sup>2</sup></strong>. The total number of passes in which <strong>&#966;</strong> decreases is also utmost <strong>2n</strong><strong><sup>2</sup></strong>.Thus the total number of passes is utmost <strong>4n</strong><strong><sup>2</sup></strong>. </li>
  <li><strong> The number of non-saturating pushes is at most 4n</strong><strong><sup>3</sup></strong>
 - There can be only one non-saturating push per vertex in a single 
pass. So the total number of non-saturating pushes is at most <strong>4n</strong><strong><sup>3</sup></strong>. </li>
</ul>
<p> On combining all the assertions, the total time required for running the first-in first-out algorithm is <strong>O(nm + n</strong><strong><sup>3</sup></strong><strong>)</strong> which is <strong>O(n<sup>3</sup>)</strong>. </p>

<p><span class="bodySubtitle">Related Problems </span><br>
In general any problem that has a solution using max-flow can be solved using <strong>“push-relabel”</strong> approach. <a href="http://www.spoj.pl/problems/TAXI">Taxi</a> and <a href="http://www.spoj.pl/problems/QUEST4">Quest4</a>
 are good problems for practice. More problems can be found in the 
article on max flow using augmenting paths. In problems where the time 
limits are very strict, push-relabel is more likely to succeed as 
compared to augmenting path approach. Moreover, the code size is not 
very significant. The code provided is of <strong>61 lines</strong> (16 + 36 + 9), and I believe it can be shortened. </p>

<p>In places where only the maximum flow value is required and the 
actual flow need not be reported, the algorithm can be changed slightly 
to work faster. The vertices that have heights <strong>&#8805;</strong><strong>n</strong>
 may not be added to the queue. This is because these vertices can never
 push more flow towards the sink. This may improve the running time by a
 factor of 2. Note that this will not change the asymptotic order of the
 algorithm. This change can also be applied in places where the min-cut 
is required. Let <strong>(S,T)</strong> be the min-cut. Then, <strong>T</strong> contains the vertices that reachable from <strong>t</strong> in the residual graph. </p>

<p><span class="bodySubtitle">References</span></p>
<ol>
  <li> Andrew V. Goldberg and Robert E. Tarjan, A new approach to the maximum-flow problem. </li>
  <li> Thomas H. Cormen, Charles E. Leiserson, Ronald L. Rivest. Introduction to Algorithms. </li>
  <li><a href="http://www.topcoder.com/tc?module=MemberProfile&amp;cr=8593420&amp;tab=alg" class="coderTextRed">_efer_</a>. <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=maxFlow">Algorithm Tutorial: MaximumFlow</a></li>
  <li><a href="http://www.topcoder.com/tc?module=MemberProfile&amp;cr=268851&amp;tab=alg" class="coderTextBlue">gladius</a>. <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=graphsDataStrucs1">Algorithm Tutorial: Introduction to graphs and their data structures</a></li>
</ol>
<br>
<p><em>The author would like to acknowledge the assistance of <a href="http://www.topcoder.com/tc?module=MemberProfile&amp;cr=20814283&amp;tab=alg" class="coderTextYellow">zenithankit</a>, who helped review and improve this article prior to publication.</em></p>
<br><br>

        </td>
<!-- Center Column Ends -->

<!-- Right Column Begins -->
         
<!-- Right Column Ends -->

<!-- Gutter -->
         
<!-- Gutter Ends -->
    </tr>
</tbody></table>

<div id="onBottom">






    
        <footer id="footer">
            <div class="container">
                <div class="footerContentSection twitter">
                    <div class="title">Twitter</div>
                    <div class="footerContent">


                        

                        <a class="btn btnFooter" href="http://www.twitter.com/topcoder"><span class="twFollowIcon"></span><span class="twFollowBtnText">Follow</span></a>
                    </div>
                </div>
                <div class="footerContentSection recentBlogPosts">
                    <div class="title">Recent Blog Posts Updated</div>
                         <div class="footerContent">
                              <div class="footerBlogEntry">
                                     <a href="http://www.topcoder.com/blog/new-look-and-feel-for-tc/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=new-look-and-feel-for-tc">Apr 23</a>

                                 @timmhicks – Tim Hicks Happy Hump Day 
topcoders! We are excited to announce that we will be releasing a new 
look for the very popular /tc by...<a href="http://www.topcoder.com/blog/new-look-and-feel-for-tc/" class="more">Read More</a></div><div class="footerBlogEntry">
                                     <a href="http://www.topcoder.com/blog/space-the-final-email-frontier/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=space-the-final-email-frontier">Apr 23</a>

                                 Do you ever find yourself hitting 
“send” on an email and wondering if it’ll arrive in the recipient’s 
inbox? Sending email has become so ubiquitous, simple and...<a href="http://www.topcoder.com/blog/space-the-final-email-frontier/" class="more">Read More</a></div><div class="footerBlogEntry">
                                     <a href="http://www.topcoder.com/blog/when-beginning-in-crowdsourcing-and-open-innovation-can-be-as-easy-as-playing-board-games/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=when-beginning-in-crowdsourcing-and-open-innovation-can-be-as-easy-as-playing-board-games">Apr 22</a>

                                 @ClintonBon – Clinton Bonner We know 
what you’re thinking. Great, another ‘puff piece’ on the ‘wisdom of 
crowds’ and how all we need to do is post...<a href="http://www.topcoder.com/blog/when-beginning-in-crowdsourcing-and-open-innovation-can-be-as-easy-as-playing-board-games/" class="more">Read More</a></div><span id="blogTemplate" style="display: none">
                                 <div class="footerBlogEntry">
                                     <a href="javascript:;"></a>

                                 </div>
                              </span>
                             <a class="btn btnFooter" href="http://www.topcoder.com/blog">View More</a>
                         </div>


                </div>
                <div class="footerContentSection aboutTopCoder">
                    <div class="title">About topcoder</div>
                    <div class="footerContent">
                        The topcoder community gathers the world's 
experts in design, development and data science to work on interesting 
and challenging problems for fun and reward. We want to help topcoder 
members improve their skills, demonstrate and gain reward for their 
expertise, and provide the industry with objective insight on new and 
emerging technologies.
                    </div>
                    <a class="btn btnFooter" href="http://www.topcoder.com/mission">About Us</a>
                </div>
                <div class="clear"></div>
            </div>
            <div class="container">
                <div class="connected">
                    <section class="social">
                        <h4>Get Connected</h4>
                        <ul>
                            <li><a class="fb" href="http://www.facebook.com/topcoder">FB</a></li>
                            <li><a class="tw" href="http://www.twitter.com/topcoder">TW</a></li>
                            <li><a class="gp" href="https://plus.google.com/u/0/b/104268008777050019973/104268008777050019973/posts">GP</a></li>
                            <li><a class="in" href="https://www.linkedin.com/company/topcoder">IN</a></li>
                        </ul>
                        <div class="clear"></div>
                    </section>
                    <section class="updates">
                        <div class="row">
                            <form id="emailForm" onsubmit="return newsletter_check(this)" name="FeedBlitz_9feab01d431311e39e69002590771423" style="display:block" method="POST" action="http://www.feedblitz.com/f/f.fbz?AddNewUserDirect">
                                <input value="Your email address" style="display: block;" class="email isBlured" name="EMAIL" placeholder="Your email address" maxlength="64" type="email">
                                <input name="FEEDID" value="926643" type="hidden">
                                <input name="PUBLISHER" value="34610190" type="hidden">
                                <!-- <a onclick="FeedBlitz_9feab01d431311e39e69002590771423s(this.form);" class="btn">Submit</a> -->
                                <input onclick="FeedBlitz_9feab01d431311e39e69002590771423s(this.form);" class="btn btnSubmitFooter" value="Submit" type="button">
                                <input name="na" value="s" type="hidden">
                                <input name="nr" value="widget" type="hidden">
                            </form>
                            <script type="text/javascript">function FeedBlitz_9feab01d431311e39e69002590771423i(){var x=document.getElementsByName('FeedBlitz_9feab01d431311e39e69002590771423');for(i=0;i<x.length;i++){x[i].EMAIL.style.display='block'; x[i].action='http://www.feedblitz.com/f/f.fbz?AddNewUserDirect';}} function FeedBlitz_9feab01d431311e39e69002590771423s(v){v.submit();}FeedBlitz_9feab01d431311e39e69002590771423i();</script>

                        </div>
                    </section>
                </div>
                <div class="copyright">
                    <section>
                        <br>
                        © 2014 topcoder. All Rights reserved.
                        <br>
                        <a href="http://www.topcoder.com/community/how-it-works/privacy-policy/" class="privacyStmtLink">Privacy Policy</a> | <a href="http://www.topcoder.com/community/how-it-works/terms/" class="legalDisclaimerLink">Terms</a>
                    </section>
                </div>
                <div class="clear"></div>
            </div>
        </footer>
    
    






<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6340959-1']);
  _gaq.push(['_setDomainName', '.topcoder.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


</div>


<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"applicationID":"5697653","applicationTime":205,"beacon":"beacon-3.newrelic.com","queueTime":0,"licenseKey":"496af5ee90","transactionName":"ZlcBbBQAChBSARIKXV8dKWs2ThAWRw0UClNdQUxVBxkCD1wVNhZBWWAGVAcDAQ8dCBUT","agent":"js-agent.newrelic.com\/nr-515.min.js","errorBeacon":"bam.nr-data.net"}</script>

<script src="maxFlowPushRelabel_files/nr-515.js"></script><script src="maxFlowPushRelabel_files/496af5ee90" type="text/javascript"></script></body></html>