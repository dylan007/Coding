<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<title>Algorithm Tutorials</title>






<script src="minimumCostFlow2_files/ga.js" async="" type="text/javascript"></script><script type="text/javascript" src="minimumCostFlow2_files/jquery-1.js"></script>
<script type="text/javascript" src="minimumCostFlow2_files/jquery-migrate-1.js"></script>
<!--[if lt IE 9]>
<script type="text/javascript" src="/js/reskin/html5shiv.js"></script>
<![endif]-->
<script type="text/javascript" src="minimumCostFlow2_files/jquery.js"></script>
<script type="text/javascript" src="minimumCostFlow2_files/newTCScript.js"></script><link type="image/x-icon" rel="shortcut icon" href="http://community.topcoder.com/i/favicon.ico">













<link href="minimumCostFlow2_files/css.css" rel="stylesheet" type="text/css">
    
    <link type="text/css" rel="stylesheet" href="minimumCostFlow2_files/coders.css">
    <link type="text/css" rel="stylesheet" href="minimumCostFlow2_files/jobsRemix.css">
    <link type="text/css" rel="stylesheet" href="minimumCostFlow2_files/myHome.css">
    
<link type="text/css" rel="stylesheet" href="minimumCostFlow2_files/newStyles.css">
<!--[if IE 8]>
<link type="text/css" rel="stylesheet" href="/css/reskin/newStyles_ie8.css"/>
<![endif]-->



<script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(n,t,e){function r(e){if(!t[e]){var o=t[e]={exports:{}};n[e][0].call(o.exports,function(t){var o=n[e][1][t];return r(o?o:t)},o,o.exports)}return t[e].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({QJf3ax:[function(n,t){function e(n){function t(t,e,a){n&&n(t,e,a),a||(a={});for(var u=c(t),f=u.length,s=i(a,o,r),p=0;f>p;p++)u[p].apply(s,e);return s}function a(n,t){f[n]=c(n).concat(t)}function c(n){return f[n]||[]}function u(){return e(t)}var f={};return{on:a,emit:t,create:u,listeners:c,_events:f}}function r(){return{}}var o="nr@context",i=n("gos");t.exports=e()},{gos:"7eSDFh"}],ee:[function(n,t){t.exports=n("QJf3ax")},{}],gos:[function(n,t){t.exports=n("7eSDFh")},{}],"7eSDFh":[function(n,t){function e(n,t,e){if(r.call(n,t))return n[t];var o=e();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(n,t,{value:o,writable:!0,enumerable:!1}),o}catch(i){}return n[t]=o,o}var r=Object.prototype.hasOwnProperty;t.exports=e},{}],D5DuLP:[function(n,t){function e(n,t,e){return r.listeners(n).length?r.emit(n,t,e):(o[n]||(o[n]=[]),void o[n].push(t))}var r=n("ee").create(),o={};t.exports=e,e.ee=r,r.q=o},{ee:"QJf3ax"}],handle:[function(n,t){t.exports=n("D5DuLP")},{}],XL7HBI:[function(n,t){function e(n){var t=typeof n;return!n||"object"!==t&&"function"!==t?-1:n===window?0:i(n,o,function(){return r++})}var r=1,o="nr@id",i=n("gos");t.exports=e},{gos:"7eSDFh"}],id:[function(n,t){t.exports=n("XL7HBI")},{}],loader:[function(n,t){t.exports=n("G9z0Bl")},{}],G9z0Bl:[function(n,t){function e(){var n=v.info=NREUM.info;if(n&&n.licenseKey&&n.applicationID&&f&&f.body){c(d,function(t,e){t in n||(n[t]=e)}),v.proto="https"===l.split(":")[0]||n.sslForHttp?"https://":"http://",a("mark",["onload",i()]);var t=f.createElement("script");t.src=v.proto+n.agent,f.body.appendChild(t)}}function r(){"complete"===f.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=n("handle"),c=n(1),u=window,f=u.document,s="addEventListener",p="attachEvent",l=(""+location).split("?")[0],d={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-515.min.js"},v=t.exports={offset:i(),origin:l,features:{}};f[s]?(f[s]("DOMContentLoaded",o,!1),u[s]("load",e,!1)):(f[p]("onreadystatechange",r),u[p]("onload",e)),a("mark",["firstbyte",i()])},{1:11,handle:"D5DuLP"}],11:[function(n,t){function e(n,t){var e=[],o="",i=0;for(o in n)r.call(n,o)&&(e[i]=t(o,n[o]),i+=1);return e}var r=Object.prototype.hasOwnProperty;t.exports=e},{}]},{},["G9z0Bl"]);</script><script language="JavaScript" src="minimumCostFlow2_files/print.js"></script>
<style type="text/css">
.math
{
   font-family: times, times new roman, serif;
   font-weight: normal;
   font-style: italic;
   font-size: 15px;
}
.code
{
   width: 500;
   padding: 10px;
   margin: 20px;
   font-size: 13px;
   font-weight: normal;
   line-height: 14px;
}
</style>
</head>
<body>
<div id="onTop">
    









    
        <header id="navigation" class="newUser">
            <div class="container">
                <div class="headerTopRightMenu">
                    
                        <div class="headerTopRightMenuLink logIn">
                            <div class="text"><a href="http://www.topcoder.com/tc?module=Logout" class="actionLogin">Log Out</a></div>
                            <div class="clear"></div>
                        </div>
                    

                    <div class="separator"></div>
                    <div class="headerTopRightMenuLink contact">
                        <div class="text"><a href="http://www.topcoder.com/contact-us/">Contact</a></div>
                        <div class="clear"></div>
                    </div>
                    <div class="separator"></div>
                    <div class="headerTopRightMenuLink help">
                        <div class="text"><a href="http://help.topcoder.com/">Help Center</a></div>
                        <div class="clear"></div>
                    </div>
                    <div class="separator beforeSearch"></div>
                    <div class="headerTopRightMenuLink search last">
                        <div class="icon"></div>
                        <div class="text"><a href="http://www.topcoder.com/search">Search</a></div>
                        <div class="clear"></div>
                    </div>
                    <div class="clear"></div>
                </div>
                <div class="clear"></div>
                <h1 class="logo">
                    <a href="http://www.topcoder.com/" title="topcoder"></a>
                </h1>
                <nav id="mainNav" class="mainNav">
                    <ul class="root">
                        <li id="nav-menu-item-13018"><a href="http://www.topcoder.com/challenges/" class="13018"><i></i>Challenges</a>
                            <ul class="child">
                                <li id="nav-menu-item-13510"><a href="http://www.topcoder.com/challenges/" class="all"><i></i>All</a></li>
                                <li id="nav-menu-item-13511"><a href="http://www.topcoder.com/active-challenges/design/" class="design"><i></i>Design</a></li>
                                <li id="nav-menu-item-13512"><a href="http://www.topcoder.com/active-challenges/develop/" class="develop"><i></i>Development</a></li>
                                <li id="nav-menu-item-13513"><a href="http://www.topcoder.com/active-challenges/data/" class="data"><i></i>Data Science</a></li>
                                <li id="nav-menu-item-13529"><a href="http://community.topcoder.com/contest/arena/ContestAppletProd.jnlp" class="topcoder-arena"><i></i>topcoder Arena</a></li>
                            </ul>
                        </li>
                        <li id="nav-menu-item-13129"><a href="http://www.topcoder.com/community/" class="13129"><i></i>Community</a>
                            <ul class="child">
                                <li id="nav-menu-item-13509"><a href="http://www.topcoder.com/community/" class="welcome"><i></i>Home</a></li>
                                <li id="nav-menu-item-13034"><a href="http://www.topcoder.com/community/getting-started/" class="13034"><i></i>Getting
                                    Started</a></li>
                                <li id="nav-menu-item-12983"><a href="http://www.topcoder.com/community/how-it-works/" class="customer-solutions"><i></i>How It Works</a></li>
                                <li id="nav-menu-item-13105"><a href="http://apps.topcoder.com/forums/" class="forums"><i></i>Forums</a></li>
                                <li id="nav-menu-item-13036"><a href="http://www.topcoder.com/community/events/" class="13036"><i></i>Events</a></li>
                                <li id="nav-menu-item-15095"><a href="http://community.topcoder.com/tco14" class="topcoder-open-2"><i></i>Topcoder Open 2014</a></li>
                                <li id="nav-menu-item-15218"><a href="http://tco15.topcoder.com/" class="topcoder-open-2015"><i></i>Topcoder Open 2015</a></li>
                                <li><a href="http://www.topcoder.com/community/member-programs/">
                                                                <i></i>Member Programs</a></li>
                                <li id="nav-menu-item-13038"><a href="http://www.topcoder.com/community/stories/" class="13038"><i></i>Stories</a></li>
                            </ul>
                        </li>
                        <li id="nav-menu-item-13469"><a href="http://community.topcoder.com/mission" class="about-us"><i></i>About topcoder</a>
                            <ul class="child">
                                <li id="nav-menu-item-13516"><a href="http://www.topcoder.com/mission/" class="13516"><i></i>Mission</a></li>
                                <li id="nav-menu-item-13032"><a href="http://www.topcoder.com/research/" class="13032"><i></i>Research</a></li>
                                <li id="nav-menu-item-13450"><a href="http://www.topcoder.com/case-studies/" class="case-studies"><i></i>Case Studies</a></li>
                                <li id="nav-menu-item-13045"><a href="http://www.topcoder.com/press/" class="13045"><i></i>Press</a></li>
                            </ul>
                        </li>
                        <li id="nav-menu-item-13379"><a href="http://www.topcoder.com/blog/" class="13379"><i></i>Blog</a></li>
                        <!--
                        <li class="noReg logoutLink 	hide"><a href="http://www.topcoder.com?auth=logout" class="actionLogout">Log Out</a></li>
                        <li class="noReg loginLink"><a href="javascript:;" class="actionLogin">Log In</a></li>
                        -->
                    </ul>
                </nav>
                <!--
                <a href="http://www.topcoder.com?auth=logout" class="onMobi noReg linkLogout actionLogout hide">Log Out</a>
                  <a href="javascript:;" class="onMobi noReg linkLogin actionLogin">Log In</a>
                -->
                
                    <span class="btnRegWrap noReg"><a href="http://www.topcoder.com/tc?module=MyHome" class="btn btnMyHome">My Home</a></span>
                

                <!-- /.userWidget -->
            </div>
        </header>
    
    




</div>

<table style="visibility: visible;" class="mainContent" width="100%" border="0" cellpadding="0" cellspacing="0">
   <tbody><tr class="alignTop" valign="top">
<!-- Left Column Begins-->
        <td id="onLeft" width="180">
         







    
        
            
            
        






<div style="width: 185px; display: block;" class="leftNavWrapper">
    
<input id="nodeName" value="algo_tutorials" type="hidden">
<script language="JavaScript" type="text/javascript" src="minimumCostFlow2_files/arena.js"></script>

    <section class="get-time" style="margin-bottom:15px">
        
        <span class="date"></span>
        <a href="javascript:tcTime();">Get Time</a>
    </section>
    <!-- End .get-time -->

    <section class="navigation">
    <ul>
        <li><a id="copilot_posting_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Copilot%20Posting">Copilot Posting</a></li>
        <li><a href="http://www.topcoder.com/active-challenges/design/">Design</a></li>
        <li>
            <a href="javascript:;">Develop<i></i></a>
            <ul class="hide">
                <li><a id="conceptualization_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Conceptualization">Conceptualization</a></li>
                <li><a id="specification_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Specification">Specification</a></li>
                <li><a id="architecture_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Architecture">Architecture</a></li>
                <li><a id="ui_prototype_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=UI%20Prototype%20Competition">UI Prototype</a></li>
                <li><a id="assembly_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Assembly%20Competition">Assembly</a></li>
                <li><a id="first2finish_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=First2Finish">First2Finish</a></li>
                <li><a id="code_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Code">Code</a></li>
                <li><a id="des_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Design">Component Design</a></li>
                <li><a id="dev_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Development">Component Development</a></li>
                <li><a id="test_suites_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Test%20Suites">Test Suites</a></li>
                <li><a id="content_creation_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Content%20Creation">Content Creation</a></li>
                <li><a id="test_scenarios_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Test%20Scenarios">Test Scenarios</a></li>
                <li><a id="bug_hunt_compete" href="http://www.topcoder.com/challenges/develop/active/?challengeTypes=Bug%20Hunt">Bug Hunt</a></li>
            </ul>
        </li>
        <li>
            <a href="javascript:;">Review Opportunities<i></i></a>
            <ul class="hide">
                <li>
                    <dl>
                        <dt>Conceptualization</dt>
                        <dd><a id="conceptualization_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=23">Review Opportunities</a></dd>
                        <dd><a id="conceptualization_review_border" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=23">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Specification</dt>
                        <dd><a id="specification_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=6">Review Opportunities</a></dd>
                        <dd><a id="specification_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=6">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Architecture</dt>
                        <dd><a id="architecture_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=7">Review Opportunities</a></dd>
                        <dd><a id="architecture_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=7">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Component Design</dt>
                        <dd><a id="des_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=1">Review Opportunities</a></dd>
                        <dd><a id="des_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=1">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Component Development</dt>
                        <dd><a id="dev_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=2">Review Opportunities</a></dd>
                        <dd><a id="dev_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=2">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Assembly</dt>
                        <dd><a id="assembly_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=14">Review Opportunities</a></dd>
                        <dd><a id="assembly_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=14">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>First2Finish</dt>
                        <dd><a id="first2finish_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=38">Review Opportunities</a></dd>
                        <dd><a id="first2finish_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=38">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Code</dt>
                        <dd><a id="code_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=39">Review Opportunities</a></dd>
                        <dd><a id="code_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=39">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Test Suites</dt>
                        <dd><a id="test_suites_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=13">Review Opportunities</a></dd>
                        <dd><a id="test_suites_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=13">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Report</dt>
                        <dd><a id="reporting_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=36">Review Opportunities</a></dd>
                        <dd><a id="reporting_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=36">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>UI prototype</dt>
                        <dd><a id="ui_prototype_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=19">Review Opportunities</a></dd>
                        <dd><a id="ui_prototype_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=19">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>RIA Build</dt>
                        <dd><a id="ria_build_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=24">Review Opportunities</a></dd>
                        <dd><a id="ria_build_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=24">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Content Creation</dt>
                        <dd><a id="content_creation_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=35">Review Opportunities</a></dd>
                        <dd><a id="content_creation_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=35">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Test Scenarios</dt>
                        <dd><a id="test_scenarios_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=26">Review Opportunities</a></dd>
                        <dd><a id="test_scenarios_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=26">Meet the review board</a></dd>
                    </dl>
                </li>
                <li>
                    <dl class="last-item">
                        <dt>Bug Hunt</dt>
                        <dd><a id="bug_hunt_review" href="http://www.topcoder.com/tc?module=ViewReviewAuctions&amp;pt=9">Review Opportunities</a></dd>
                        <dd><a id="bug_hunt_review_board" href="http://www.topcoder.com/tc?module=ReviewBoard&amp;pt=9">Meet the review board</a></dd>
                    </dl>
                </li>

            </ul>
        </li>
        <li>
            <a href="javascript:;">Algorithm (SRM)<i></i></a>
            <ul class="hide">
                <li><a href="http://www.topcoder.com/active-challenges/data/">Single Round Matches (SRM)</a></li>
                <li><a id="algo_match_archive" href="http://www.topcoder.com/tc?module=MatchList">Match Archive</a></li>
                <li><a id="algo_match_overviews" href="http://www.topcoder.com/stat?c=round_overview">Match Overviews</a></li>
                <li><a id="algo_match_winners" href="http://www.topcoder.com/tc?module=SrmDivisionWins">Match Winners</a></li>
                <li><a id="algo_match_results" href="http://www.topcoder.com/stat?c=last_match">Match Results</a></li>
                <li><a href="http://apps.topcoder.com/wiki/display/tc/Algorithm+Problem+Set+Analysis">Match Editorials</a></li>
                <li><a id="algo_problem_archive" href="http://www.topcoder.com/tc?module=ProblemArchive">Problem Archive</a></li>
                <li><a id="algo_color_changes" href="http://www.topcoder.com/tc?module=ColorChange&amp;ratid=1">Recent Color Changes</a></li>
                <li><a href="http://apps.topcoder.com/wiki/display/tc/Algorithm+Data+Feeds">Data Feeds</a></li>
                <li><a href="javascript:arena();">Launch Arena</a></li>
            </ul>
        </li>
        <li>
            <a href="javascript:;">Marathon Match<i></i></a>
            <ul class="hide">
                <li><a id="long_compete" href="http://www.topcoder.com/challenges/data/active/">Challenges</a></li>
                <li><a id="long_match_archive" href="http://www.topcoder.com/challenges/data/past/">Match Archive</a></li>
                <li><a id="long_match_overview" href="http://www.topcoder.com/longcontest/stats/?module=ViewOverview">Match Overview</a></li>
                <li><a id="long_match_winners" href="http://www.topcoder.com/longcontest/stats/?module=MatchWinners">Match Winners</a></li>
                <li><a id="long_editorials" href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=match_editorials&amp;d2=archive">Match Editorials</a></li>
                <li><a id="long_data_feeds" href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=support&amp;d2=dataFeed">Data Feeds</a></li>
                <li><a id="long_practice" href="http://www.topcoder.com/longcontest/?module=ViewPractice">Practice</a></li>
                <li><a id="long_queue" href="http://www.topcoder.com/longcontest/?module=ViewQueue">Queue Status</a></li>
            </ul>
        </li>
        <li><a href="http://www.topcoder.com/dr">The Digital Run</a></li>
        <li><a href="http://software.topcoder.com/review">Submit &amp; Review</a></li>
        <li>
            <a href="javascript:;">topcoder Networks<i></i></a>
            <ul class="hide">
                <li><a href="http://community.topcoder.com/ntl/">NASA Tournament Lab</a></li>
            </ul>
        </li>
        <li><a href="http://www.topcoder.com/community/events/">Events</a></li>
        <li>
            <a href="javascript:;">Statistics<i></i></a>
            <ul class="hide">
                <li>
                    <dl>
                        <dt>Top Ranked</dt>
                        <dd><a id="top_rated_algo" href="http://www.topcoder.com/tc?module=AlgoRank">Algorithm</a></dd>
                        <dd><a id="top_rated_hs" href="http://www.topcoder.com/tc?module=HSRank">High School</a></dd>
                        <dd><a id="top_rated_long" href="http://www.topcoder.com/longcontest/stats/?module=CoderRank">Marathon Match</a></dd>
                        <dd><a id="top_rated_conceptors" href="http://www.topcoder.com/stat?c=top_conceptors">Conceptualization</a></dd>
                        <dd><a id="top_rated_specificators" href="http://www.topcoder.com/stat?c=top_specificators">Specification</a></dd>
                        <dd><a id="top_rated_architects" href="http://www.topcoder.com/stat?c=top_architects">Architecture</a></dd>
                        <dd><a id="top_rated_des" href="http://www.topcoder.com/stat?c=top_designers">Design</a></dd>
                        <dd><a id="top_rated_dev" href="http://www.topcoder.com/stat?c=top_developers">Development</a></dd>
                        <dd><a id="top_rated_assemblers" href="http://www.topcoder.com/stat?c=top_assemblers">Assembly</a></dd>
                        <dd><a id="top_rated_testers" href="http://www.topcoder.com/stat?c=top_testers">Test Suites</a></dd>
                    </dl>
                </li>
                <li>
                    <dl>
                        <dt>Record Book</dt>
                        <dd><a id="algo_recordbook" href="http://www.topcoder.com/tc?module=Static&amp;d1=statistics&amp;d2=recordbook_home">Algorithm</a></dd>
                        <dd><a id="comp_recordbook" href="http://www.topcoder.com/tc?module=Static&amp;d1=compstats&amp;d2=comp_recordbook_home">Component</a></dd>
                        <dd><a id="long_recordbook" href="http://www.topcoder.com/longcontest/?module=Static&amp;d1=stats&amp;d2=recordbook_home">Marathon Match</a></dd>
                    </dl>
                </li>
                <li>
                    <dl class="last-item">
                        <dt>Coder of the Month</dt>
                        <dd><a id="algo_com" href="http://www.topcoder.com/tc?module=COMHistory&amp;achtid=5">Algorithm</a></dd>
                        <dd><a id="des_com" href="http://www.topcoder.com/tc?module=COMHistory&amp;achtid=6">Design</a></dd>
                        <dd><a id="dev_com" href="http://www.topcoder.com/tc?module=COMHistory&amp;achtid=7">Development</a></dd>
                    </dl>
                </li>
            </ul>
        </li>
        <li class="expanded">
            <a href="javascript:;">Tutorials<i></i></a>
            <ul style="display: block;" class="hide">
                <li><a style="color: rgb(255, 138, 0); font-weight: bold;" id="algo_tutorials" href="http://help.topcoder.com/data-science/competing-in-algorithm-challenges/algorithm-tutorials/">Algorithm Tutorials</a></li>
                <li><a id="comp_tutorials" href="http://help.topcoder.com/development/competing-in-development-challenges/development-tutorials/">Software Tutorials</a></li>
                <li><a id="mm_tutorials" href="http://help.topcoder.com/data-science/competing-in-algorithm-challenges/marathon-match-tutorials/">Marathon Tutorials</a></li>
            </ul>
        </li>
        <li><a href="https://apps.topcoder.com/forums/" id="forums">Forums</a></li>
        <li><a href="https://www.topcoder.com/tc?module=MyHome" id="my_topcoder">My topcoder</a></li>
    </ul>
</section>
<!-- End .navigation -->
<section class="member-search">
    <h3>Member Search</h3>
    <div class="form">
        <form action="http://community.topcoder.com/tc" method="get" name="simpleSearchForm" class="noSpace" id="simpleSearchForm">
            <input class="noSpace" name="module" value="SimpleSearch" type="hidden">
            <input class="noSpace" name="ha" value="Handle:" size="12" maxlength="15" onfocus="javascript: if (document.simpleSearchForm.ha.value=='Handle:') document.simpleSearchForm.ha.value = '';" onblur="javascript:if (document.simpleSearchForm.ha.value == '')document.simpleSearchForm.ha.value = 'Handle:';" type="text">
            <a href="javascript:javascript:void%20document.simpleSearchForm.submit();" class="btn btn-search-member"><i>SEARCH</i></a>
        </form>
    </div>
</section>

<!-- End .member-search -->

</div>

    
    



        </td>
<!-- Left Column Ends -->

<!-- Center Column Begins -->
         <td width="100%" align="center">

         <div class="tutorBodyFull">







<table style="visibility: visible;" class="pageTitleTable" cellpadding="0" cellspacing="0">
    <tbody><tr>
        <td class="pageTitle" width="100%">


            
                
                    
                    <img src="minimumCostFlow2_files/header_alg_tut.gif" alt="alg_tut" border="0">
                
                
            


        </td>
        <td class="pageSubtitle" align="right">&nbsp;&nbsp;</td>
    </tr>
</tbody></table>



<div class="linkBox">
    <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=alg_index">Archive</a><br>
    <span id="printableLink"><a href="javascript:makeInvisible();">Printable view</a><br></span>
    <span id="navigableLink" class="invisible"><a href="javascript:makeNavigable();">Normal view</a><br></span>
    <a href="http://forums.topcoder.com/?module=ThreadList&amp;forumID=515317">Discuss this article</a><br>
    <a href="http://community.topcoder.com/tc?module=Static&amp;d1=help&amp;d2=writeForTC">Write for TopCoder</a>
</div>

<span class="bigTitle">Minimum Cost Flow, Part 2: Algorithms</span>
<br><br>

<div class="authorPhoto">
    <img src="minimumCostFlow2_files/Zealint_big.jpg" alt="Author">
</div>

<div class="authorText">
  By&nbsp;<a href="http://www.topcoder.com/tc?module=MemberProfile&amp;cr=22671469&amp;tab=alg" class="coderTextBlue">Zealint</a> <br>
      <em>TopCoder Member</em>
</div>

<br clear="all">
<p>In <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=minimumCostFlow1">Part 1</a>,
 we looked at the basics of minimum cost flow. In this section, we'll 
look at three algorithms that can be applied to minimum cost flow 
problems.</p>

<p><span class="bodySubtitle">Working with Residual Networks</span><br>
Let's consider the  concept of residual networks from the perspective of
 min-cost flow theory. You should be familiar with this concept thanks 
to <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=maxFlow" target="_blank">maximum flow</a> theory, so we'll just extend it to minimum cost flow theory.</p>

<p>We start with the following intuitive idea. Let <span class="math">G</span> be a network and <span class="math">x</span> be a feasible solution of the minimum cost flow problem. Suppose that an edge <span class="math">(i,j)</span> in <span class="math">E</span> carries <span class="math">x<sub>ij</sub></span> units of flow. We define the residual capacity of the edge <span class="math">(i,j)</span> as <span class="math">r<sub>ij</sub> = u<sub>ij</sub> - x<sub>ij</sub></span>. This means that we can send an additional <span class="math">r<sub>ij</sub></span> units of flow from vertex <span class="math">i</span> to vertex <span class="math">j</span>. We can also cancel the existing flow <span class="math">x<sub>ij</sub></span> on the arc if we send up <span class="math">x<sub>ij</sub></span> units of flow from <span class="math">j</span> to <span class="math">i</span> over the arc <span class="math">(i,j)</span>. Now note that sending a unit of flow from <span class="math">i</span> to <span class="math">j</span> along the arc <span class="math">(i,j)</span> increases the objective function by <span class="math">c<sub>ij</sub></span>, while sending a unit of flow from <span class="math">j</span> to <span class="math">i</span> on the same arc decreases the flow cost by <span class="math">c<sub>ij</sub></span>.</p>

<div align="center"><img src="minimumCostFlow2_files/Figure_2_1.png" alt="Figure 2_1" style="margin: 10px;" border="0"></div>

<blockquote><b>Figure 1</b>. The transportation network from Part 1. (a)
 A feasible solution. (b) The residual network with respect to the found
 feasible solution.</blockquote>

<p>Based on these ideas we define the residual network with respect to the given flow <span class="math">x</span> as follows. Suppose we have a transportation network <span class="math">G = (V,E)</span>. A feasible solution <span class="math">x</span> engenders a new (residual) transportation network, which we are used to defining by <span class="math">G<sub>x</sub> = (V,E<sub>x</sub>)</span>, where <span class="math">E<sub>x</sub></span> is a set of residual edges corresponding to the feasible solution <span class="math">x</span>.</p>

<p>What is <span class="math">E<sub>x</sub></span>? We replace each arc <span class="math">(i,j)</span> in <span class="math">E</span> by two arcs <span class="math">(i,j)</span>, <span class="math">(j,i)</span>: the arc <span class="math">(i,j)</span> has cost <span class="math">c<sub>ij</sub></span> and (residual) capacity <span class="math">r<sub>ij</sub> = u<sub>ij</sub> - x<sub>ij</sub></span>, and the arc <span class="math">(j,i)</span> has cost <span class="math">-c<sub>ij</sub></span> and (residual) capacity <span class="math">r<sub>ji</sub>=x<sub>ij</sub></span>. Then we construct the set <span class="math">E<sub>x</sub></span>
 from the new edges with a positive residual capacity. Look at Figure 1 
to make sure that you understand the construction of the residual 
network.</p>

<p>You can notice immediately that such a definition of the residual network has some technical difficulties. Let's sum them up:</p>

<ul>
<li>If <span class="math">G</span> contains both the edges <span class="math">(i,j)</span> and <span class="math">(j,i)</span> (remember assumption 2) the residual network may contain four edges between <span class="math">i</span> and <span class="math">j</span> (two parallel arcs from <span class="math">i</span> to <span class="math">j</span>
 and two contrary). To avoid this situation we have two options. First, 
transform the original network to one in which the network contains 
either edge <span class="math">(i,j)</span> or edge <span class="math">(j,i)</span>, but not both, by splitting the vertexes <span class="math">i</span> and <span class="math">j</span>.
 Second, represent our network by the adjacency list, which is handling 
parallel arcs. We could even use two adjacency matrixes if it were more 
convenient.</li>
<li>Let's imagine now that we have a lot of parallel edges from <span class="math">i</span> to <span class="math">j</span>
 with different costs. Unfortunately, we can't merge them by summarizing
 their capacities, as we could do while we were finding the maximum 
flow. So, we need to keep each of the parallel edges in our data 
structure separate.</li>
</ul>

<p>The proof of the fact that there is a one-to-one correspondence 
between the original and residual networks is out the scope of this 
article, but you could prove all the necessary theorems as it was done 
within the maximum flow theory, or by reading [<a href="#1">1</a>].</p>

<p><span class="bodySubtitle">Cycle-canceling Algorithm</span><br>
This section describes the negative cycle optimality conditions and, as a
 consequence, cycle-canceling algorithm. We are starting with this 
important theorem:</p>

<p><i><b>Theorem 1 (Solution Existence)</b>. Let <span class="math">G</span> be a transportation network. Suppose that <span class="math">G</span>
 contains no uncapacitated negative cost cycle and there exists a 
feasible solution of the minimum cost flow problem. Then the optimal 
solution exists.</i></p>

<p><i>Proof</i>. One can see that the minimum cost flow problem is a 
special case of the linear programming problem. The latter is well known
 to have an optimal solution if it has a feasible solution and its 
objective function is bounded. Evidently, if <span class="math">G</span>
 doesn't contain an uncapacitated negative cycle then the objective 
function of the minimum cost flow problem is bounded from below -- 
therefore, the assertion of the theorem follows forthwith.</p>

<p>We will use the following theorem without proof, because we don't 
want our article to be overloaded with difficult theory, but you can 
read the proof in [<a href="#1">1</a>].</p>

<p><i><b>Theorem 2 (Negative Cycle Optimality Conditions)</b>. Let <span class="math">x*</span> be a feasible solution of a minimum cost flow problem. Then <span class="math">x*</span> is an optimal solution if and only if the residual network <span class="math">G<sub>x*</sub></span> contains no negative cost (directed) cycle.</i></p>

<div align="center"><img src="minimumCostFlow2_files/Figure_2_2.png" alt="Figure 2_2" style="margin: 10px;" border="0"></div>

<blockquote><b>Figure 2</b>. Cycle-Canceling Algorithm, example of the 
network from Figure 1. (a) We have a feasible solution of cost 54. (b) A
 negative cycle 1-2-3-1 is detected in the residual network. Its cost is
 -1 and capacity is 1. (c) The residual network after augmentation along
 the cycle. (d) Another negative cost cycle 3-4-5-3 is detected. It has 
cost -2 and capacity 3. (e) The residual network after augmentation. It 
doesn't contain negative cycles. (f) Optimal flow cost value is equal to
 47.</blockquote>

<p>This theorem gives the cycle-canceling algorithm for solving the 
minimum cost flow problem. First, we use any maximum flow algorithm [<a href="#3">3</a>]
 to establish a feasible flow in the network (remember assumption 4). 
Then the algorithm attempts to improve the objective function by finding
 negative cost cycles in the residual network and augmenting the flow on
 these cycles. Let us specify a program in pseudo code like it is done 
in [<a href="#1">1</a>].</p>

<pre class="code">Cycle-Canceling

<b>1</b>    Establish a feasible flow <span class="math">x</span> in the network
<b>2</b>    <b>while</b> ( <span class="math">G<sub>x</sub></span> contains a negative cycle ) <b>do</b>
<b>3</b>        identify a negative cycle <span class="math">W</span>
<b>4</b>        <img alt="" src="minimumCostFlow2_files/02_001.png" style="padding: 0px 3px 0px 3px;" align="top">
<b>5</b>        augment <img alt="" src="minimumCostFlow2_files/02_002.png" style="padding: 0px 3px 0px 3px;" align="top"> units of flow along the cycle <span class="math">W</span>
<b>6</b>        update <span class="math">G<sub>x</sub></span> 
</pre>

<p>How many iterations does the algorithm perform? First, note that due 
to assumption 1 all the data is integral. After line 1 of the program we
 have an integral feasible solution <span class="math">x</span>. It implies the integrality of <span class="math">G<sub>x</sub></span>.
 In each iteration of the cycle in line 2 the algorithm finds the 
minimum residual capacity in the found negative cycle. In the first 
iteration <img alt="" src="minimumCostFlow2_files/02_002.png" style="padding: 0px 3px 0px 3px;" align="top">
 will be an integer. Therefore, the modified residual capacities will be
 integers, too. And in all subsequent iterations the residual capacities
 will be integers again. This reasoning implies:</p>

<p><i><b>Theorem 3 (Integrality Property)</b>. If all edge capacities 
and supplies/demands on vertexes are integers, then the minimum cost 
flow problem always has an integer solution.</i></p>

<p>The cycle-canceling algorithm works in cases when the minimum cost 
flow problem has an optimal solution and all the data is integral and we
 don't need any other assumptions.</p>

<p>Now let us denote the maximum capacity of an arc by <span class="math">U</span> and its maximum absolute value of cost by <span class="math">C</span>. Suppose that <span class="math">m</span> denotes the number of edges in <span class="math">G</span> and <span class="math">n</span> denotes the number of vertexes. For a minimum cost flow problem, the absolute value of the objective function is bounded by <span class="math">mCU</span>.
 Any cycle canceling decreases the objective function by a strictly 
positive amount. Since we are assuming that all data is integral, the 
algorithm terminates within <span class="math">O(mCU)</span> iterations. One can use <span class="math">O(nm)</span> algorithm for identifying a negative cycle (for instance, Bellman-Ford's algorithm or label correcting algorithm [<a href="#1">1</a>]), and obtain complexity <span class="math">O(nm<sup>2</sup>CU)</span> of the algorithm.</p>

<p><span class="bodySubtitle">Successive Shortest Path Algorithm</span><br>
The previous algorithm solves the maximum flow problem as a subtask. The
 successive shortest path algorithm searches for the maximum flow and 
optimizes the objective function simultaneously. It solves the so-called
 max-flow-min-cost problem by using the following idea.</p>

<p>Suppose we have a transportation network <span class="math">G</span> 
and we have to find an optimal flow across it. As it is described in the
 "Finding a Solution" section we transform the network by adding two 
vertexes <span class="math">s</span> and <span class="math">t</span> (source and sink) and some edges as follows. For each node <span class="math">i</span> in <span class="math">V</span> with <span class="math">b<sub>i</sub> &gt; 0</span>, we add a source arc <span class="math">(s,i)</span> with capacity <span class="math">b<sub>i</sub></span> and cost <span class="math">0</span>. For each node <span class="math">i</span> in <span class="math">V</span> with <span class="math">b<sub>i</sub> &lt; 0</span>, we add a sink arc <span class="math">(i,t)</span> with capacity <span class="math">-b<sub>i</sub></span> and cost <span class="math">0</span>.</p>

<p>Then, instead of searching for the maximum flow as usual, we send flow from <span class="math">s</span> to <span class="math">t</span>
 along the shortest path (with respect to arc costs). Next we update the
 residual network, find another shortest path and augment the flow 
again, etc. The algorithm terminates when the residual network contains 
no path from <span class="math">s</span> to <span class="math">t</span> 
(the flow is maximal). Since the flow is maximal, it corresponds to a 
feasible solution of the original minimum cost flow problem. Moreover, 
this solution will be optimal (and we are going to explain why).</p>

<p>The successive shortest path algorithm can be used when <span class="math">G</span>
 contains no negative cost cycles. Otherwise, we cannot say exactly what
 "the shortest path" means. Now let us justify the successive shortest 
path approach. When the current flow has zero value, the transportation 
network <span class="math">G</span> doesn't contain a negative cost cycle (by hypothesis). Suppose that after some augmenting steps we have flow <span class="math">x</span> and <span class="math">G<sub>x</sub></span> still contains no negative cycles. If <span class="math">x</span> is maximal then it is optimal, according to theorem 2. Otherwise, let us denote the next successfully found shortest path in <span class="math">G<sub>x</sub></span> by <span class="math">P</span>.</p>

<div align="center"><img src="minimumCostFlow2_files/Figure_2_3.png" alt="Figure 2_3" style="margin: 10px;" border="0"></div>

<blockquote><b>Figure 3</b>. How could a negative cycle appear in a residual network?</blockquote>

<p>Suppose that after augmenting the current flow <span class="math">x</span> along path <span class="math">P</span> a negative cost cycle <span class="math">W</span> turned up in the residual network. Before augmenting there were no negative cycles. This means that there was an edge <span class="math">(i,j)</span> in <span class="math">P</span> (or subpath <span class="math">(i,…,j)</span> in <span class="math">P</span>) the reversal of which <span class="math">(j,i)</span> closed cycle <span class="math">W</span> after the augmentation. Evidently, we could choose another path from <span class="math">s</span> to <span class="math">t</span>, which goes from <span class="math">s</span> to <span class="math">i</span> then from <span class="math">i</span> to <span class="math">j</span> along edges of <span class="math">W</span> then from <span class="math">j</span> to <span class="math">t</span>. Moreover, the cost of this path is less than the cost of <span class="math">P</span>. We have a contradiction to the supposition that <span class="math">P</span> is the shortest.</p>

<p>What do we have? After the last step we have a feasible solution and 
the residual network contains no negative cycle. The latter is the 
criterion of optimality.</p>

<p>A simple analysis shows that the algorithm performs at most <span class="math">O(nB)</span> augmentations, where <span class="math">B</span>
 is assigned to an upper bound on the largest supply of any node. 
Really, each augmentation strictly decreases the residual capacity of a 
source arc (which is equal to the supply of the corresponding node). 
Thanks to the integrality property it decreases by at least one unit. By
 using an <span class="math">O(nm)</span> algorithm for finding a shortest path (there may be negative edges), we achieve an <span class="math">O(n<sup>2</sup>mB)</span> complexity of the successive shortest path algorithm.</p>

<pre class="code">Successive Shortest Path
<b>1</b>    Transform network <span class="math">G</span> by adding source and sink
<b>2</b>    Initial flow <span class="math">x</span> is zero
<b>3</b>    <b>while</b> ( <span class="math">G<sub>x</sub></span> contains a path from <span class="math">s</span> to <span class="math">t</span> ) <b>do</b>
<b>4</b>        Find any shortest path <span class="math">P</span> from <span class="math">s</span> to <span class="math">t</span>
<b>5</b>        Augment current flow <span class="math">x</span> along <span class="math">P</span>
<b>6</b>        update <span class="math">G<sub>x</sub></span>
</pre>

<p>Let us reveal the meaning of node potentials from assumption 3. As it
 is said within assumption 3, we are able to make all edge costs 
nonnegative by using, for instance, Bellman-Ford's algorithm. Since 
working with residual costs doesn't change shortest paths (by theorem 2,
 part 1) we can work with the transformed network and use Dijkstra's 
algorithm to find the successive shortest path more efficiently. 
However, we need to keep the edge costs nonnegative on each iteration --
 for this purpose, we update node potentials and reduce costs right 
after the shortest path has been found. The reduce cost function could 
be written in the following manner:</p>

<pre class="code">Reduce Cost ( <img alt="" src="minimumCostFlow2_files/02_003.png" style="padding: 0px 3px 0px 3px;" align="top"> )
<b>1</b>    <b>For each</b> <span class="math">(i,j)</span> in <span class="math">E<sub>x</sub></span> <b>do</b>
<b>2</b>         <img alt="" src="minimumCostFlow2_files/02_004.png" style="padding: 0px 3px 0px 3px;" align="top">
<b>3</b>         <img alt="" src="minimumCostFlow2_files/02_005.png" style="padding: 0px 3px 0px 3px;" align="top">
</pre>

<p>Having found the successive shortest path we need to update node potentials. For each <span class="math">i</span> in <span class="math">V</span> the potential <img alt="" src="minimumCostFlow2_files/02_006.png" style="padding: 0px 3px 0px 3px;" align="top"> is equal to the length of the shortest paths from <span class="math">s</span> to <span class="math">t</span>. After having reduced the cost of each arc, we will see that along the shortest path from <span class="math">s</span> to <span class="math">i</span>
 arcs will have zero cost while the arcs which lie out of any shortest 
path to any vertex will have a positive cost. That is why we assign zero
 cost to any reversal arc <span class="math">(c<sub>rev(i,j)</sub>)</span> in the Reduce Cost Procedure in line 3. The augmentation (along the found path) adds reversal arc <span class="math">(j,i)</span> and due to the fact that (reduced) cost <span class="math">c<sub>ij</sub> = 0</span> we make <span class="math">(c<sub>rev(i,j)</sub>) = 0</span> beforehand.</p>

<p>Why have we denoted cost of reversal arc by <span class="math">(c<sub>rev(i,j)</sub>)</span> instead of <span class="math">c<sub>ji</sub></span>? Because the network may contain both arcs <span class="math">(i,j)</span> and <span class="math">(j,i)</span>
 (remember assumption 2 and "Working with Residual Networks" section). 
For other arcs (which lie out of the augmenting path) this forcible 
assignment does nothing, because its reversal arcs will not appear in 
the residual network. Now we propose a pseudo-code program:</p>

<pre class="code">Successive Shortest Path with potentials
<b>1</b>    Transform network <span class="math">G</span> by adding source and sink
<b>2</b>    Initial flow <span class="math">x</span> is zero
<b>3</b>    Use Bellman-Ford's algorithm to establish potentials <img alt="" src="minimumCostFlow2_files/02_003.png" style="padding: 0px 3px 0px 3px;" align="top">
<b>4</b>    Reduce Cost ( <img alt="" src="minimumCostFlow2_files/02_003.png" style="padding: 0px 3px 0px 3px;" align="top"> )
<b>5</b>    <b>while</b> ( <span class="math">G<sub>x</sub></span> contains a path from <span class="math">s</span> to <span class="math">t</span> ) <b>do</b>
<b>6</b>        Find any shortest path <span class="math">P</span> from <span class="math">s</span> to <span class="math">t</span>
<b>7</b>        Reduce Cost ( <img alt="" src="minimumCostFlow2_files/02_003.png" style="padding: 0px 3px 0px 3px;" align="top"> )
<b>8</b>        Augment current flow <span class="math">x</span> along <span class="math">P</span>
<b>9</b>        update <span class="math">G<sub>x</sub></span>
</pre>

<p>Before starting the cycle in line 5 we calculate node potentials <img alt="" src="minimumCostFlow2_files/02_003.png" style="padding: 0px 3px 0px 3px;" align="top"> and obtain all costs to be nonnegative. We use the same massif of costs <span class="math">c</span>
 when reducing. In line 6 we use Dijkstra's algorithm to establish a 
shortest path with respect to the reduced costs. Then we reduce costs 
and augment flow along the path. After the augmentation all costs will 
remain nonnegative and in the next iteration Dijkstra's algorithm will 
work correctly.</p>

<div align="center"><img src="minimumCostFlow2_files/Figure_2_4.png" alt="Figure 2_4" style="margin: 10px;" border="0"></div>

<blockquote><b>Figure 4</b>. The Successive shortest Path Algorithm. (a)
 Initial task. (b) Node potentials are calculated after line 3 of the 
program. (c) Reduced costs after line 4. (d) The first augmenting path 
s-1-2-3-4-t of capacity 2 is found and new node potentials are 
calculated. (e) The residual network with reduced costs. (f) The second 
augmenting path s-1-3-4-t of capacity 1 is found. (g) The residual 
network with reduced costs. (h) The third shortest augmenting path 
s-1-3-5-t and new node potentials are found. (i) The residual network 
contains no augmenting paths. (j) The reconstructed transportation 
network. Optimal flow has cost 12.</blockquote>

<p>We use Bellman-Ford's algorithm only once to avoid negative costs on edges. It takes <span class="math">O(nm)</span> time. Then <span class="math">O(nB)</span> times we use Dijkstra algorithm, which takes either <span class="math">O(n<sup>2</sup>)</span> (simple realization) or <span class="math">O(m</span>log<span class="math">n)</span> (heap realization for sparse network, [<a href="#4">4</a>]) time. Summing up, we receive <span class="math">O(n<sup>3</sup>B)</span> estimate working time for simple realization and <span class="math">O(nmB</span>log<span class="math">n)</span> if using heap. One could even use Fibonacci Heaps to obtain <span class="math">O(n</span>log<span class="math">n+m)</span>
 complexity of Dijkstra's shortest path algorithm; however I wouldn't 
recommend doing so because this case works badly in practice.</p>

<p><span class="bodySubtitle">Primal-Dual Algorithm</span><br>
The primal-dual algorithm for the minimum cost flow problem is similar 
to the successive shortest path algorithm in the sense that it also uses
 node potentials and shortest path algorithm to calculate them. Instead 
of augmenting the flow along one shortest path, however, this algorithm 
increases flow along all the shortest paths at once. For this purpose in
 each step it uses any maximum flow algorithm to find the maximum flow 
through the so called <strong>admissible network</strong>, which contains only those arcs in <span class="math">G<sub>x</sub></span> with a zero reduced cost. We represent the admissible residual network with respect to flow <span class="math">x</span> as <img alt="" src="minimumCostFlow2_files/02_007.png" style="padding: 0px 3px 0px 3px;" align="top">. Let's explain the idea by using a pseudo-code program.</p>

<pre class="code">Primal-Dual
<b>1</b>    Transform network <span class="math">G</span> by adding source and sink
<b>2</b>    Initial flow <span class="math">x</span> is zero
<b>3</b>    Use Bellman-Ford's algorithm to establish potentials <img alt="" src="minimumCostFlow2_files/02_003.png" style="padding: 0px 3px 0px 3px;" align="top">
<b>4</b>    Reduce Cost ( <img alt="" src="minimumCostFlow2_files/02_003.png" style="padding: 0px 3px 0px 3px;" align="top"> )
<b>5</b>    <b>while</b> ( <span class="math">G<sub>x</sub></span> contains a path from <span class="math">s</span> to <span class="math">t</span> ) <b>do</b>
<b>6</b>        Calculate node potential <img alt="" src="minimumCostFlow2_files/02_003.png" style="padding: 0px 3px 0px 3px;" align="top"> using Dijkstra's algorithm
<b>7</b>        Reduce Cost ( <img alt="" src="minimumCostFlow2_files/02_003.png" style="padding: 0px 3px 0px 3px;" align="top"> )
<b>8</b>        Establish a maximum flow <span class="math">y</span> from <span class="math">s</span> to <span class="math">t</span> in <img alt="" src="minimumCostFlow2_files/02_007.png" style="padding: 0px 3px 0px 3px;" align="top">
<b>9</b>        <span class="math">x <img alt="" src="minimumCostFlow2_files/02_008.png" style="padding: 0px 3px 0px 3px;" align="top"> x + y</span>
<b>10</b>       update <span class="math">G<sub>x</sub></span>
</pre>

<p>For a better illustration look at Figure 5.</p>

<div align="center"><img src="minimumCostFlow2_files/Figure_2_5.png" alt="Figure 2_5" style="margin: 10px;" border="0"></div>
 
<blockquote><b>Figure 5</b>. Primal-Dual algorithm. (a) Example network.
 (b) Node potentials are calculated. (c) The maximum flow in the 
admissible network. (d) Residual network and new node potentials. (e) 
The maximum flow in the admissible network. (f) Residual network with no
 augmenting paths. (g)  The optimal solution.</blockquote>

<p>As mentioned above, the primal-dual algorithm sends flow along all 
shortest paths at once; therefore, proof of correctness is similar to 
the successive shortest path one.</p>

<p>First, the primal-dual algorithm guarantees that the number of iterations doesn't exceed <span class="math">O(nB)</span> as well as the successive shortest path algorithm. Moreover, since we established a maximum flow in <img alt="" src="minimumCostFlow2_files/02_007.png" style="padding: 0px 3px 0px 3px;" align="top">, the residual network <span class="math">G<sub>x</sub></span> contains no directed path from vertex <span class="math">s</span> to vertex <span class="math">t</span> consisting entirely of arcs of zero costs. Consequently, the distance between <span class="math">s</span> and <span class="math">t</span> increases by at least one unit. These observations give a bound of <span class="math">min{nB,nC}</span>
 on the number of iterations which the primal-dual algorithm performs. 
Keep in mind, though, that the algorithm incurs the additional expense 
of solving a maximum flow problem at every iteration. However, in 
practice both the successive shortest path and the primal-dual algorithm
 work fast enough within the constraint of 50 vertexes and reasonable 
supply/demand values and costs.</p>

<p>In the <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=minimumCostFlow3">next section</a>, we'll discuss some applications of the minimum cost flow problem.</p>

<p><span class="bodySubtitle">References</span><br>
[<a name="1">1</a>]&nbsp;&nbsp;Ravindra K. Ahuja, Thomas L. Magnanti, and James B. Orlin. <i>Network Flows: Theory, Algorithms, and Applications</i>.<br>
[<a name="2">2</a>]&nbsp;&nbsp;Thomas H. Cormen, Charles E. Leiserson, Ronald L. Rivest. <i>Introduction to Algorithms</i>.<br>
[<a name="3">3</a>]&nbsp;&nbsp;<a href="http://www.topcoder.com/tc?module=MemberProfile&amp;cr=8593420&amp;tab=alg" class="coderTextRed">_efer_</a>. Algorithm Tutorial: <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=maxFlow" target="_blank">Maximum Flow</a>.<br>
[<a name="4">4</a>]&nbsp;&nbsp;<a href="http://www.topcoder.com/tc?module=MemberProfile&amp;cr=268851&amp;tab=alg" class="coderTextBlue">gladius</a>. Algorithm Tutorial: <a href="http://community.topcoder.com/tc?module=Static&amp;d1=tutorials&amp;d2=graphsDataStrucs3" target="_blank">Introduction to graphs and their data structures: Section 3</a>.<br>
</p>

        </div>
        <p><br></p>
        </td>
<!-- Center Column Ends -->

<!-- Right Column Begins -->
         <td id="onRight" width="170">
            



<script type="text/javascript" language="javascript">

</script>




    <div style="width:150px;">
        &nbsp;
    </div>


         </td>
<!-- Right Column Ends -->

<!-- Gutter -->
         <td width="10"><img src="minimumCostFlow2_files/clear.gif" height="1" width="10" border="0"></td>
<!-- Gutter Ends -->
    </tr>
</tbody></table>

<div id="onBottom">






    
        <footer id="footer">
            <div class="container">
                <div class="footerContentSection twitter">
                    <div class="title">Twitter</div>
                    <div class="footerContent">


                        

                        <a class="btn btnFooter" href="http://www.twitter.com/topcoder"><span class="twFollowIcon"></span><span class="twFollowBtnText">Follow</span></a>
                    </div>
                </div>
                <div class="footerContentSection recentBlogPosts">
                    <div class="title">Recent Blog Posts Updated</div>
                         <div class="footerContent">
                              <div class="footerBlogEntry">
                                     <a href="http://www.topcoder.com/blog/new-look-and-feel-for-tc/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=new-look-and-feel-for-tc">Apr 23</a>

                                 @timmhicks – Tim Hicks Happy Hump Day 
topcoders! We are excited to announce that we will be releasing a new 
look for the very popular /tc by...<a href="http://www.topcoder.com/blog/new-look-and-feel-for-tc/" class="more">Read More</a></div><div class="footerBlogEntry">
                                     <a href="http://www.topcoder.com/blog/space-the-final-email-frontier/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=space-the-final-email-frontier">Apr 23</a>

                                 Do you ever find yourself hitting 
“send” on an email and wondering if it’ll arrive in the recipient’s 
inbox? Sending email has become so ubiquitous, simple and...<a href="http://www.topcoder.com/blog/space-the-final-email-frontier/" class="more">Read More</a></div><div class="footerBlogEntry">
                                     <a href="http://www.topcoder.com/blog/when-beginning-in-crowdsourcing-and-open-innovation-can-be-as-easy-as-playing-board-games/?utm_source=rss&amp;utm_medium=rss&amp;utm_campaign=when-beginning-in-crowdsourcing-and-open-innovation-can-be-as-easy-as-playing-board-games">Apr 22</a>

                                 @ClintonBon – Clinton Bonner We know 
what you’re thinking. Great, another ‘puff piece’ on the ‘wisdom of 
crowds’ and how all we need to do is post...<a href="http://www.topcoder.com/blog/when-beginning-in-crowdsourcing-and-open-innovation-can-be-as-easy-as-playing-board-games/" class="more">Read More</a></div><span id="blogTemplate" style="display: none">
                                 <div class="footerBlogEntry">
                                     <a href="javascript:;"></a>

                                 </div>
                              </span>
                             <a class="btn btnFooter" href="http://www.topcoder.com/blog">View More</a>
                         </div>


                </div>
                <div class="footerContentSection aboutTopCoder">
                    <div class="title">About topcoder</div>
                    <div class="footerContent">
                        The topcoder community gathers the world's 
experts in design, development and data science to work on interesting 
and challenging problems for fun and reward. We want to help topcoder 
members improve their skills, demonstrate and gain reward for their 
expertise, and provide the industry with objective insight on new and 
emerging technologies.
                    </div>
                    <a class="btn btnFooter" href="http://www.topcoder.com/mission">About Us</a>
                </div>
                <div class="clear"></div>
            </div>
            <div class="container">
                <div class="connected">
                    <section class="social">
                        <h4>Get Connected</h4>
                        <ul>
                            <li><a class="fb" href="http://www.facebook.com/topcoder">FB</a></li>
                            <li><a class="tw" href="http://www.twitter.com/topcoder">TW</a></li>
                            <li><a class="gp" href="https://plus.google.com/u/0/b/104268008777050019973/104268008777050019973/posts">GP</a></li>
                            <li><a class="in" href="https://www.linkedin.com/company/topcoder">IN</a></li>
                        </ul>
                        <div class="clear"></div>
                    </section>
                    <section class="updates">
                        <div class="row">
                            <form id="emailForm" onsubmit="return newsletter_check(this)" name="FeedBlitz_9feab01d431311e39e69002590771423" style="display:block" method="POST" action="http://www.feedblitz.com/f/f.fbz?AddNewUserDirect">
                                <input value="Your email address" style="display: block;" class="email isBlured" name="EMAIL" placeholder="Your email address" maxlength="64" type="email">
                                <input name="FEEDID" value="926643" type="hidden">
                                <input name="PUBLISHER" value="34610190" type="hidden">
                                <!-- <a onclick="FeedBlitz_9feab01d431311e39e69002590771423s(this.form);" class="btn">Submit</a> -->
                                <input onclick="FeedBlitz_9feab01d431311e39e69002590771423s(this.form);" class="btn btnSubmitFooter" value="Submit" type="button">
                                <input name="na" value="s" type="hidden">
                                <input name="nr" value="widget" type="hidden">
                            </form>
                            <script type="text/javascript">function FeedBlitz_9feab01d431311e39e69002590771423i(){var x=document.getElementsByName('FeedBlitz_9feab01d431311e39e69002590771423');for(i=0;i<x.length;i++){x[i].EMAIL.style.display='block'; x[i].action='http://www.feedblitz.com/f/f.fbz?AddNewUserDirect';}} function FeedBlitz_9feab01d431311e39e69002590771423s(v){v.submit();}FeedBlitz_9feab01d431311e39e69002590771423i();</script>

                        </div>
                    </section>
                </div>
                <div class="copyright">
                    <section>
                        <br>
                        © 2014 topcoder. All Rights reserved.
                        <br>
                        <a href="http://www.topcoder.com/community/how-it-works/privacy-policy/" class="privacyStmtLink">Privacy Policy</a> | <a href="http://www.topcoder.com/community/how-it-works/terms/" class="legalDisclaimerLink">Terms</a>
                    </section>
                </div>
                <div class="clear"></div>
            </div>
        </footer>
    
    






<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6340959-1']);
  _gaq.push(['_setDomainName', '.topcoder.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


</div>


<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"applicationID":"5697673","applicationTime":131,"beacon":"beacon-3.newrelic.com","queueTime":0,"licenseKey":"496af5ee90","transactionName":"ZlcBbBQAChBSARIKXV8dKWs2ThAWRw0UClNdQUxVDw8NDkYPJQxBRXQPVxFTSglAEg==","agent":"js-agent.newrelic.com\/nr-515.min.js","errorBeacon":"bam.nr-data.net"}</script>


</body></html>